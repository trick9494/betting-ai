<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Betting AI ‚Äì MultiSport Pro</title>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        body.dark-mode {
            background-color: #121212;
            color: #f0f0f0;
        }
        .dark-mode input, .dark-mode select, .dark-mode textarea {
            background-color: #1e1e1e;
            color: #ffffff;
            border: 1px solid #444;
        }
        .dark-mode button {
            background-color: #333;
            color: #fff;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
        }
        .dark-mode button:hover {
            background-color: #555;
        }
        .header {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-radius: 0 0 10px 10px;
        }
        .metric-card {
            background-color: #f0f2f6;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #1f77b4;
            transition: background-color 0.3s;
        }
        .dark-mode .metric-card {
            background-color: #2a2a2a;
        }
        .success-card {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
        }
        .dark-mode .success-card {
            background-color: #1e4620;
        }
        .warning-card {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        .dark-mode .warning-card {
            background-color: #42350e;
        }
        .danger-card {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        .dark-mode .danger-card {
            background-color: #4a1c24;
        }
        .sport-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .sport-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .active-sport {
            border: 3px solid #0d6efd;
            background-color: #e8f4ff;
        }
        .dark-mode .active-sport {
            background-color: #1e3a5f;
        }
        .hidden {
            display: none;
        }
        .consiglio-box {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .value-positive {
            color: #28a745;
            font-weight: bold;
        }
        .value-negative {
            color: #dc3545;
            font-weight: bold;
        }
        .saved-forecast {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: white;
            transition: background-color 0.3s;
        }
        .dark-mode .saved-forecast {
            background-color: #2a2a2a;
            border-color: #444;
        }
        .saved-forecast-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .dark-mode .saved-forecast-header {
            border-bottom-color: #444;
        }
        .toggle-dark-mode {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background-color: #6c757d;
            color: white;
            border: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .toggle-dark-mode:hover {
            background-color: #5a6268;
        }
        .form-text {
            font-size: 0.875em;
            color: #6c757d;
        }
        .dark-mode .form-text {
            color: #adb5bd;
        }
        .error-message {
            color: #dc3545;
            font-size: 0.875em;
            margin-top: 5px;
        }
        .chart-container {
            margin-bottom: 20px;
        }
        .ai-analysis-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .reason-item {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 10px 15px;
            margin: 8px 0;
            border-left: 4px solid #4CAF50;
        }
        .warning-reason {
            border-left-color: #FFC107;
        }
        .danger-reason {
            border-left-color: #F44336;
        }
        .market-badge {
            background: #6f42c1;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            margin-left: 8px;
        }
        .tipo-pronostico {
            background: #17a2b8;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75em;
        }
        .dropdown-menu-pronostico {
            max-height: 400px;
            overflow-y: auto;
        }
        .dropdown-toggle-pronostico {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .dropdown-toggle-pronostico::after {
            margin-left: 10px;
        }
        .giocatore-fields {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            border-left: 4px solid #17a2b8;
        }
        .dark-mode .giocatore-fields {
            background-color: #2a2a2a;
        }
        
        /* Stili per il pannello dei pronostici salvati */
        .saved-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background-color: white;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1050;
            overflow-y: auto;
            padding: 20px;
        }
        .dark-mode .saved-panel {
            background-color: #1e1e1e;
            color: #f0f0f0;
        }
        .saved-panel.open {
            right: 0;
        }
        .saved-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        .dark-mode .saved-panel-header {
            border-bottom-color: #444;
        }
        .saved-panel-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0;
        }
        .close-panel {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
        }
        .dark-mode .close-panel {
            color: #adb5bd;
        }
        .saved-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .saved-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .dark-mode .saved-item {
            background-color: #2a2a2a;
            border-color: #444;
        }
        .saved-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .saved-item-sport {
            font-weight: bold;
            color: #0d6efd;
        }
        .saved-item-date {
            font-size: 0.8rem;
            color: #6c757d;
        }
        .dark-mode .saved-item-date {
            color: #adb5bd;
        }
        .saved-item-match {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .saved-item-forecast {
            margin-bottom: 5px;
        }
        .saved-item-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        .saved-item-stat {
            text-align: center;
        }
        .saved-item-stat-value {
            font-weight: bold;
            font-size: 1.1rem;
        }
        .saved-item-stat-label {
            font-size: 0.8rem;
            color: #6c757d;
        }
        .dark-mode .saved-item-stat-label {
            color: #adb5bd;
        }
        .saved-item-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 10px;
        }
        .delete-saved {
            background: none;
            border: none;
            color: #dc3545;
            cursor: pointer;
            font-size: 1.2rem;
        }
        .toggle-saved-panel {
            position: fixed;
            bottom: 80px;
            right: 20px;
            z-index: 1000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background-color: #0d6efd;
            color: white;
            border: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .toggle-saved-panel:hover {
            background-color: #0b5ed7;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1040;
            display: none;
        }
        .overlay.active {
            display: block;
        }
        .no-saved {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }
        .dark-mode .no-saved {
            color: #adb5bd;
        }
        
        /* Stili per il regolamento */
        .regolamento-panel {
            position: fixed;
            top: 0;
            left: -400px;
            width: 400px;
            height: 100vh;
            background-color: white;
            box-shadow: 5px 0 15px rgba(0,0,0,0.1);
            transition: left 0.3s ease;
            z-index: 1050;
            overflow-y: auto;
            padding: 20px;
        }
        .dark-mode .regolamento-panel {
            background-color: #1e1e1e;
            color: #f0f0f0;
        }
        .regolamento-panel.open {
            left: 0;
        }
        .regolamento-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        .dark-mode .regolamento-panel-header {
            border-bottom-color: #444;
        }
        .regolamento-panel-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0;
        }
        .close-regolamento {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
        }
        .dark-mode .close-regolamento {
            color: #adb5bd;
        }
        .regolamento-section {
            margin-bottom: 25px;
        }
        .regolamento-section h4 {
            color: #0d6efd;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #0d6efd;
        }
        .dark-mode .regolamento-section h4 {
            border-bottom-color: #0d6efd;
        }
        .regolamento-item {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        .dark-mode .regolamento-item {
            background-color: #2a2a2a;
        }
        .regolamento-item h5 {
            margin-bottom: 10px;
            color: #495057;
            font-size: 1.1rem;
        }
        .dark-mode .regolamento-item h5 {
            color: #adb5bd;
        }
        .regolamento-field {
            margin-bottom: 8px;
            padding-left: 10px;
            border-left: 2px solid #6c757d;
        }
        .regolamento-field strong {
            color: #495057;
        }
        .dark-mode .regolamento-field strong {
            color: #adb5bd;
        }
        .regolamento-example {
            background-color: #e9ecef;
            padding: 8px 12px;
            border-radius: 5px;
            margin-top: 8px;
            font-style: italic;
            font-size: 0.9rem;
        }
        .dark-mode .regolamento-example {
            background-color: #343a40;
        }
        .toggle-regolamento {
            position: fixed;
            bottom: 140px;
            right: 20px;
            z-index: 1000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background-color: #28a745;
            color: white;
            border: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .toggle-regolamento:hover {
            background-color: #218838;
        }
        
        /* Stili per la visualizzazione dettagliata del pronostico salvato */
        .saved-detail-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            z-index: 1060;
            overflow-y: auto;
            padding: 20px;
            display: none;
        }
        .dark-mode .saved-detail-panel {
            background-color: #121212;
            color: #f0f0f0;
        }
        .saved-detail-panel.open {
            display: block;
        }
        .saved-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        .dark-mode .saved-detail-header {
            border-bottom-color: #444;
        }
        .saved-detail-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0;
        }
        .close-detail {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
        }
        .dark-mode .close-detail {
            color: #adb5bd;
        }
        
        /* Stili per le statistiche avanzate Over/Under */
        .stats-advanced {
            background-color: #e8f4f8;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #17a2b8;
        }
        .dark-mode .stats-advanced {
            background-color: #1e2a3a;
        }
        .stats-header {
            font-weight: bold;
            margin-bottom: 10px;
            color: #17a2b8;
        }
        .stats-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .stats-label {
            font-weight: 500;
        }
        .stats-value {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- Overlay per chiudere i pannelli -->
    <div class="overlay" id="overlay"></div>
    
    <!-- Pannello dei pronostici salvati -->
    <div class="saved-panel" id="savedPanel">
        <div class="saved-panel-header">
            <h3 class="saved-panel-title"><i class="bi bi-bookmark"></i> Pronostici Salvati</h3>
            <button class="close-panel" id="closePanel"><i class="bi bi-x-lg"></i></button>
        </div>
        <div id="savedForecastsList">
            <!-- I pronostici salvati verranno inseriti qui -->
        </div>
    </div>
    
    <!-- Pannello del regolamento -->
    <div class="regolamento-panel" id="regolamentoPanel">
        <div class="regolamento-panel-header">
            <h3 class="regolamento-panel-title"><i class="bi bi-info-circle"></i> Regolamento di Compilazione</h3>
            <button class="close-regolamento" id="closeRegolamento"><i class="bi bi-x-lg"></i></button>
        </div>
        <div class="regolamento-content">
            <div class="regolamento-section">
                <h4>üèÄ BASKET - TUTTI I MERCATI</h4>
                
                <div class="regolamento-item">
                    <h5>üèÄ Punti Giocatore (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] punti" + nome giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media punti segnati dal giocatore (ultime 5-10 partite)
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Minimo 5 partite, ideale 8-10 partite
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valore proposto dal bookmaker (es. 27.5, 25.5, 30.5)
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> "X su Y" partite dove il giocatore ha superato/sottoperato la soglia
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Minuti giocati, ruolo in attacco, avversario (difesa forte/debole)
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "LeBron James Over 27.5 punti"<br>
                        Media: 28.3 punti (ultime 10 partite) | Soglia: 27.5 | Successi: 7/10 (70%)<br>
                        <em>Analisi: Giocatore in forma, media superiore alla soglia, alta percentuale successi</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üìà Rimbalzi Giocatore (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] rimbalzi" + nome giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media rimbalzi totali (offensivi + difensivi)
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Minimo 8 partite per dati significativi
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori tipici: 9.5, 10.5, 11.5, 12.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Percentuale partite Over/Under la soglia
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Altezza giocatore, ruolo sotto canestro, stile di gioco squadra
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Nikola Jokiƒá Over 10.5 rimbalzi"<br>
                        Media: 11.2 rimbalzi (ultime 12 partite) | Soglia: 10.5 | Successi: 9/12 (75%)<br>
                        <em>Analisi: Centro dominante, alta media rimbalzi, consistenza dimostrata</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üéØ Assist Giocatore (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] assist" + nome giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media assist per partita
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Minimo 10 partite (statistica variabile)
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori comuni: 8.5, 9.5, 10.5, 11.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza assist rispetto alla soglia
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Ruolo di playmaker, percentuale utilizzo, efficienza attacco squadra
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Trae Young Over 9.5 assist"<br>
                        Media: 10.1 assist (ultime 15 partite) | Soglia: 9.5 | Successi: 11/15 (73%)<br>
                        <em>Analisi: Playmaker principale, alta creazione gioco, squadra offensiva</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>‚≠ê Performance Multiple (Punti+Rimbalzi+Assist)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] P+R+A" + nome giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Somma media di Punti + Rimbalzi + Assist
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Minimo 8 partite per stabilit√†
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori tipici: 35.5, 40.5, 45.5, 50.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Performance complessive rispetto alla soglia
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Versatilit√† giocatore, minuti giocati, importanza nella squadra
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Luka Donƒçiƒá Over 45.5 P+R+A"<br>
                        Media: 47.3 PRA (ultime 10 partite) | Soglia: 45.5 | Successi: 7/10 (70%)<br>
                        <em>Analisi: Giocatore franchise, alte statistiche multiple, ruolo centrale</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üèÜ Vincitore Partita (1/X/2)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "1" (casa), "2" (ospite), "X" (pareggio)
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Percentuale vittorie squadra casa/ospite
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 10 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Testa a testa diretti, prestazioni recenti
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Forma attuale, infortuni, motivazione, fattore campo
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Lakers vincenti (1)"<br>
                        Lakers: 7 vittorie/10 partite (70%) | Warriors: 4 vittorie/10 partite (40%)<br>
                        <em>Analisi: Squadra casa in forma migliore, vantaggio del fattore campo</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>‚öñÔ∏è Handicap Punti</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Squadra -/+ [handicap]" (es. "Lakers -5.5")
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Differenza media punti tra le squadre
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultimi 5-8 scontri diretti
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Handicap proposto dal bookmaker
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza copertura handicap
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Forza relativa, partite casalinghe/trasferta, stile di gioco
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Lakers -5.5"<br>
                        Media differenza punti: +7.2 (ultimi 8 scontri) | Handicap: -5.5 | Successi: 6/8 (75%)<br>
                        <em>Analisi: Squadra superiore, vantaggio costante, handicap ragionevole</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üî¢ Punti Totali Partita (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] punti totali"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media punti totali delle due squadre combinate
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 5-8 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori tipici: 215.5, 220.5, 225.5, 230.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza Over/Under negli scontri diretti
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Ritmo di gioco, difese, percentuali dal campo
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Over 225.5 punti totali"<br>
                        Media punti totali: 228.3 (ultimi 5 incontri) | Soglia: 225.5 | Successi: 4/5 (80%)<br>
                        <em>Analisi: Squadre offensive, alto ritmo, storie recenti di partite ad alto punteggio</em>
                    </div>
                </div>
            </div>
            
            <div class="regolamento-section">
                <h4>‚öΩ CALCIO - TUTTI I MERCATI</h4>
                
                <div class="regolamento-item">
                    <h5>ü•Ö Over/Under Gol - ANALISI COMPLETA</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] gol" (es. "Over 2.5 gol")
                    </div>
                    <div class="regolamento-field">
                        <strong>Media Gol Fatti Squadra 1:</strong> Media gol segnati (ultime 5-8 partite)
                    </div>
                    <div class="regolamento-field">
                        <strong>Media Gol Subiti Squadra 1:</strong> Media gol concessi (ultime 5-8 partite)
                    </div>
                    <div class="regolamento-field">
                        <strong>Media Gol Fatti Squadra 2:</strong> Media gol segnati (ultime 5-8 partite)
                    </div>
                    <div class="regolamento-field">
                        <strong>Media Gol Subiti Squadra 2:</strong> Media gol concessi (ultime 5-8 partite)
                    </div>
                    <div class="regolamento-field">
                        <strong>Calcolo Media Attesa:</strong> [(Fatti1 + Subiti2) + (Fatti2 + Subiti1)] √∑ 2
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> 0.5, 1.5, 2.5, 3.5 gol
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Percentuale partite Over/Under negli scontri diretti
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Attacchi efficienti, difese solide, motivazione, importanza partita
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Over 2.5 gol"<br>
                        Juventus: 1.8 gol fatti, 0.8 gol subiti | Inter: 2.1 gol fatti, 1.0 gol subiti<br>
                        Media Attesa: [(1.8+1.0) + (2.1+0.8)] √∑ 2 = 2.85 gol | Soglia: 2.5 | Successi: 6/10 (60%)<br>
                        <em>Analisi: Attacchi forti, difese non impenetrabili, media attesa superiore alla soglia</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üîÑ Doppia Chance (1X/X2/12)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "1X" (casa non perde), "X2" (ospite non perde), "12" (no pareggio)
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Percentuale risultati 1X/X2/12 negli scontri diretti
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultimi 8-10 scontri diretti e recenti
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza esito 1X/X2/12
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Forza relativa, partite casalinghe/trasferta, forma attuale
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "1X - Juventus non perde"<br>
                        Juventus casa: 8 vittorie/10 partite, 2 pareggi | Inter in trasferta: 3 vittorie/10 partite<br>
                        Successi 1X: 9/10 (90%) negli ultimi scontri a Torino<br>
                        <em>Analisi: Forte squadra casa, prestazioni solide in trasferta avversaria</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üéØ Risultato Esatto</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Score esatto" (es. "2-1", "1-1", "3-0")
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Frequenza risultati specifici negli scontri
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Storia completa scontri diretti
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Percentuale volte che si √® verificato esattamente quel risultato
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Stile di gioco, attacchi, difese, precedenti
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Risultato Esatto 2-1"<br>
                        Frequenza 2-1: 3/10 (30%) negli ultimi scontri | Media gol: 2.8 per partita<br>
                        <em>Analisi: Risultato frequente nello scontro, allineato con medie gol</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>‚ùå Gol/No Gol</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Gol" o "No Gol"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Percentuale partite con/almeno un gol
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 10 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza Gol/No Gol negli scontri
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Qualit√† attacchi, solidit√† difese, importanza partita
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Gol"<br>
                        Juventus: gol segnati in 9/10 partite | Inter: gol segnati in 8/10 partite<br>
                        Successi "Gol": 8/10 (80%) negli scontri diretti<br>
                        <em>Analisi: Squadre offensivamente pericolose, alta probabilit√† almeno un gol</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>‚öΩ Both Teams to Score (BTTS)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Si - Both teams to score" o "No - Both teams to score"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Percentuale partite con entrambe le squadre a segno
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 8-10 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza BTTS Si/No negli scontri
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Qualit√† attacchi, vulnerabilit√† difese, stile di gioco
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Si - Both teams to score"<br>
                        Juventus: BTTS Si in 7/10 partite | Inter: BTTS Si in 6/10 partite<br>
                        Successi BTTS Si: 7/10 (70%) negli scontri diretti<br>
                        <em>Analisi: Attacchi forti, difese non impenetrabili, storia di gol da entrambe</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üî¢ Pari/Dispari Gol Totali</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Pari" o "Dispari"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Distribuzione risultati Pari/Dispari
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultimi 10-15 scontri diretti
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Percentuale risultati Pari/Dispari
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Pattern risultati, stile di gioco squadre
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Dispari"<br>
                        Risultati Dispari: 7/10 (70%) negli ultimi scontri | Media gol: 2.7 (tendenza dispari)<br>
                        <em>Analisi: Storia recente favorevole ai risultati dispari, pattern consolidato</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üéØ Tiri Totali Partita (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] tiri totali"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media tiri totali per partita di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 8 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori tipici: 8.5, 9.5, 10.5, 11.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza Over/Under tiri negli scontri
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Stile di gioco, possesso palla, attacchi propositivi
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Over 9.5 tiri totali"<br>
                        Juventus: 13.2 tiri/partita | Inter: 12.8 tiri/partita | Media combinata: 26.0 tiri<br>
                        Soglia: 9.5 tiri per squadra (19 totali) | Successi Over: 7/10 (70%)<br>
                        <em>Analisi: Squadre offensive, alto volume tiri, media ben sopra la soglia</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üìê Corner Totali (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] corner"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media corner per partita di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 8-10 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori comuni: 8.5, 9.5, 10.5, 11.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza Over/Under corner negli scontri
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Attacchi laterali, difese, stile di gioco
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Over 10.5 corner"<br>
                        Juventus: 5.8 corner/partita | Inter: 6.2 corner/partita | Media combinata: 12.0 corner<br>
                        Soglia: 10.5 | Successi Over: 8/10 (80%) negli scontri<br>
                        <em>Analisi: Squadre con attacchi prolungati, alta frequenza corner, media sopra soglia</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üü® Cartellini Totali (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "Over/Under [soglia] cartellini"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media cartellini per partita di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 8-10 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori tipici: 3.5, 4.5, 5.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza Over/Under cartellini negli scontri
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Arbitro, importanza partita, rivalit√†, stile di gioco
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Over 4.5 cartellini"<br>
                        Juventus: 2.3 cartellini/partita | Inter: 2.5 cartellini/partita | Media combinata: 4.8<br>
                        Soglia: 4.5 | Successi Over: 6/10 (60%) | Arbitro: Rossi (media 5.1 cartellini/partita)<br>
                        <em>Analisi: Derby, arbitro severo, medie squadre sopra la soglia</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>‚è±Ô∏è Risultato Primo Tempo</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "1 primo tempo", "X primo tempo", "2 primo tempo"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Percentuale risultati primo tempo
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 10 partite di ogni squadra
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza esiti primo tempo negli scontri
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Approccio alla partita, partite casalinghe/trasferta
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "1 primo tempo - Juventus in vantaggio"<br>
                        Juventus casa: in vantaggio al 1¬∞ tempo in 6/10 partite<br>
                        Inter in trasferta: in svantaggio al 1¬∞ tempo in 5/10 partite<br>
                        Successi: 5/10 (50%) negli scontri a Torino<br>
                        <em>Analisi: Squadra casa forte all'inizio, avversaria lenta in trasferta</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>‚öΩ Marcatore (Giocatore)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "[Giocatore] marcatore" o "[Giocatore] primo/ultimo gol"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media gol per partita del giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 10-15 partite del giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Percentuale partite in cui il giocatore ha segnato
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Minuti giocati, rigori, punizioni, forma attuale
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Cristiano Ronaldo marcatore"<br>
                        Media: 0.8 gol/partita (ultime 10 partite) | Successi: 6/10 (60%)<br>
                        Rigori: 3/4 realizzati | Minuti medi: 85'<br>
                        <em>Analisi: Attaccante prolifico, titolare fisso, realizzatore affidabile</em>
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üéØ Assist Giocatore (Over/Under)</h5>
                    <div class="regolamento-field">
                        <strong>Pronostico Specifico:</strong> "[Giocatore] Over/Under [soglia] assist"
                    </div>
                    <div class="regolamento-field">
                        <strong>Valore statistico rilevante:</strong> Media assist per partita del giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Numero eventi analizzati:</strong> Ultime 10-15 partite del giocatore
                    </div>
                    <div class="regolamento-field">
                        <strong>Soglia pronostico:</strong> Valori tipici: 0.5, 1.5
                    </div>
                    <div class="regolamento-field">
                        <strong>Successi storici:</strong> Frequenza assist rispetto alla soglia
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattori chiave:</strong> Ruolo creativo, compagni di attacco, minuti giocati
                    </div>
                    <div class="regolamento-example">
                        <strong>Esempio affidabile:</strong> "Kevin De Bruyne Over 0.5 assist"<br>
                        Media: 0.7 assist/partita (ultime 15 partite) | Soglia: 0.5 | Successi: 10/15 (67%)<br>
                        Ruolo: regista | Minuti: 87'/partita<br>
                        <em>Analisi: Creatore principale, alta frequenza assist, ruolo chiave nell'attacco</em>
                    </div>
                </div>
            </div>
            
            <div class="regolamento-section">
                <h4>üìä INDICAZIONI GENERALI PER ANALISI AFFIDABILI</h4>
                
                <div class="regolamento-item">
                    <h5>‚úÖ CAMPIONE MINIMO DATI</h5>
                    <div class="regolamento-field">
                        <strong>Statistiche Giocatore:</strong> Minimo 8-10 partite recenti
                    </div>
                    <div class="regolamento-field">
                        <strong>Statistiche Squadra:</strong> Minimo 8-10 partite recenti
                    </div>
                    <div class="regolamento-field">
                        <strong>Scontri Diretti:</strong> Tutta la storia disponibile (minimo 5-8 incontri)
                    </div>
                    <div class="regolamento-field">
                        <strong>Dati Recenti:</strong> Privilegiare ultime 5-10 partite (forma attuale)
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>üéØ SOGLIE DI AFFIDABILIT√Ä</h5>
                    <div class="regolamento-field">
                        <strong>Probabilit√† Alta:</strong> ‚â• 65% - Forte raccomandazione
                    </div>
                    <div class="regolamento-field">
                        <strong>Probabilit√† Media:</strong> 55-64% - Buona opportunit√†
                    </div>
                    <div class="regolamento-field">
                        <strong>Probabilit√† Bassa:</strong> ‚â§ 54% - Approccio con cautela
                    </div>
                    <div class="regolamento-field">
                        <strong>Value Bet:</strong> ‚â• +5% - Quota bookmaker vantaggiosa
                    </div>
                </div>
                
                <div class="regolamento-item">
                    <h5>‚ö†Ô∏è FATTORI DI RISCHIO</h5>
                    <div class="regolamento-field">
                        <strong>Infortuni:</strong> Verificare presenza/assenza giocatori chiave
                    </div>
                    <div class="regolamento-field">
                        <strong>Motivazione:</strong> Importanza partita (salvezza, titolo, coppe)
                    </div>
                    <div class="regolamento-field">
                        <strong>Fattore Campo:</strong> Considerare prestazioni casa/trasferta
                    </div>
                    <div class="regolamento-field">
                        <strong>Condizioni Meteo:</strong> Influiscono su stile di gioco e risultati
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="header text-center">
        <h1><i class="bi bi-bullseye"></i> Betting AI ‚Äì MultiSport Pro</h1>
        <p class="lead">Analisi intelligente per TUTTI i mercati dei bookmaker</p>
    </div>

    <div class="container">
        <!-- Selezione Sport -->
        <div class="row mb-4">
            <div class="col-12">
                <h3 class="mb-3">üèÜ Scegli lo sport</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card sport-card text-center active-sport" id="basket-card" onclick="showSport('basket')">
                            <div class="card-body">
                                <i class="bi bi-basketball fs-1"></i>
                                <h5 class="card-title">Basket</h5>
                                <small class="text-muted">NBA, Euroleague, etc.</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card sport-card text-center" id="calcio-card" onclick="showSport('calcio')">
                            <div class="card-body">
                                <i class="bi bi-soccer fs-1"></i>
                                <h5 class="card-title">Calcio</h5>
                                <small class="text-muted">Serie A, Champions, etc.</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <hr>

        <!-- BASKET SECTION -->
        <div id="basket-section">
            <h3 class="mb-4"><i class="bi bi-basketball"></i> Basket ‚Äì Analisi Multi-Mercato</h3>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üèÄ Squadra 1</label>
                        <input type="text" class="form-control" id="basket-squadra1" placeholder="es. Los Angeles Lakers" required>
                        <div class="error-message" id="basket-squadra1-error"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üèÄ Squadra 2</label>
                        <input type="text" class="form-control" id="basket-squadra2" placeholder="es. Golden State Warriors" required>
                        <div class="error-message" id="basket-squadra2-error"></div>
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label class="form-label">üéØ Tipo Pronostico Basket</label>
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-pronostico w-100" type="button" id="dropdownBasket" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="selected-basket-option">üèÄ Punti Giocatore</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-pronostico w-100" aria-labelledby="dropdownBasket">
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('punti-over-under', 'üèÄ Punti Giocatore')">üèÄ Punti Giocatore<br><small>Over/Under punti giocatore</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('rimbalzi-over-under', 'üìà Rimbalzi Giocatore')">üìà Rimbalzi Giocatore<br><small>Over/Under rimbalzi</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('assist-over-under', 'üéØ Assist Giocatore')">üéØ Assist Giocatore<br><small>Over/Under assist</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('performance-multipla', '‚≠ê Performance Multiple')">‚≠ê Performance Multiple<br><small>Punti+Rimbalzi+Assist</small></a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('vincitore', 'üèÜ Vincitore Partita')">üèÜ Vincitore Partita<br><small>1, X, 2</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('handicap', '‚öñÔ∏è Handicap')">‚öñÔ∏è Handicap<br><small>Handicap punti</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('punti-totali', 'üî¢ Punti Totali Partita')">üî¢ Punti Totali Partita<br><small>Over/Under punti totali</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('custom', '‚úèÔ∏è Personalizzato')">‚úèÔ∏è Personalizzato<br><small>Altri mercati</small></a></li>
                    </ul>
                </div>
                <input type="hidden" id="basket-tipo-pronostico" value="punti-over-under">
            </div>
            
            <!-- CAMPI GIOCATORE BASKET -->
            <div id="basket-giocatore-fields">
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üë§ Nome Giocatore</label>
                            <input type="text" class="form-control" id="basket-giocatore" placeholder="es. LeBron James" required>
                            <div class="error-message" id="basket-giocatore-error"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üèÄ Squadra Giocatore</label>
                            <select class="form-control" id="basket-squadra-giocatore" required>
                                <option value="">Seleziona squadra</option>
                                <option value="squadra1">Squadra 1</option>
                                <option value="squadra2">Squadra 2</option>
                            </select>
                            <div class="error-message" id="basket-squadra-giocatore-error"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label class="form-label">üìä Pronostico Specifico</label>
                <input type="text" class="form-control" id="basket-pronostico" placeholder="es. Over 27.5 punti" required>
                <div class="error-message" id="basket-pronostico-error"></div>
                <div class="form-text" id="basket-esempi-pronostico">
                    Esempi: "Over 27.5 punti", "Under 9.5 rimbalzi", "Over 8.5 assist"
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üìà Valore statistico rilevante</label>
                        <input type="number" step="0.1" class="form-control" id="basket-totale" value="0" min="0" required>
                        <div class="form-text">Media punti/rimbalzi/assist del giocatore</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üî¢ Numero eventi analizzati</label>
                        <input type="number" step="1" class="form-control" id="basket-eventi" value="0" min="0" required>
                        <div class="form-text">Partite considerate per la statistica</div>
                    </div>
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üéØ Soglia pronostico</label>
                        <input type="number" step="0.1" class="form-control" id="basket-soglia" value="0" min="0" required>
                        <div class="form-text">Soglia del bookmaker (es. 27.5 per Over 27.5 punti)</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üí∞ Quota bookmaker</label>
                        <input type="number" step="0.01" class="form-control" id="basket-quota" value="1.80" min="1.01" required>
                    </div>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="form-label">üìä Successi storici</label>
                <input type="text" class="form-control" id="basket-successi" placeholder="es. 6 su 10, 70%">
                <div class="form-text">Quante volte √® successo storicamente? (es. "6/10" o "70%")</div>
            </div>
            
            <div class="d-grid gap-2">
                <button class="btn btn-primary btn-lg" onclick="analizzaBasket()"><i class="bi bi-cpu"></i> Analisi AI Avanzata</button>
            </div>
            
            <div id="basket-results" class="mt-4 hidden">
                <h3 class="mb-4">üìä Risultati Analisi Basket</h3>
                
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Probabilit√†</h6>
                            <h3 id="basket-probabilita">0%</h3>
                            <span id="basket-prob-diff">+0.0%</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Quota Teorica</h6>
                            <h3 id="basket-quota-teorica">0.00</h3>
                            <span id="basket-quota-diff">+0.00</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Value Margin</h6>
                            <h3 id="basket-value-margin">+0.0%</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Mercato</h6>
                            <h3 id="basket-mercato">-</h3>
                            <span id="basket-tipo">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div id="basket-grafico-prob"></div>
                    <div id="basket-grafico-quote"></div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">Dettagli Analisi</h5>
                        <p><strong>üèÄ Match:</strong> <span id="basket-match"></span></p>
                        <p><strong>üë§ Giocatore:</strong> <span id="basket-giocatore-result"></span> (<span id="basket-squadra-giocatore-result"></span>)</p>
                        <p><strong>üìä Pronostico:</strong> <span id="basket-pronostico-result"></span> <span class="tipo-pronostico" id="basket-tipo-badge"></span></p>
                        <p><strong>üìà Media Statistica:</strong> <span id="basket-media"></span></p>
                        <p><strong>üéØ Soglia Bookmaker:</strong> <span id="basket-soglia-result"></span></p>
                        <p><strong>üîç Metodo Analisi:</strong> <span id="basket-metodo"></span></p>
                        <p><strong>üìä Successi Storici:</strong> <span id="basket-successi-result"></span></p>
                    </div>
                </div>
                
                <!-- ANALISI DETTAGLIATA AI -->
                <div id="basket-analisi-ai" class="ai-analysis-card">
                    <h4 class="text-center mb-4">üß† Analisi Dettagliata AI</h4>
                    <div id="basket-ragionamento-ai"></div>
                </div>
                
                <div id="basket-consiglio" class="consiglio-box"></div>
                
                <div class="d-grid gap-2 mt-3">
                    <button class="btn btn-success" onclick="salvaPronostico('basket')"><i class="bi bi-save"></i> Salva Pronostico</button>
                </div>
            </div>
        </div>

        <!-- CALCIO SECTION -->
        <div id="calcio-section" class="hidden">
            <h3 class="mb-4"><i class="bi bi-soccer"></i> Calcio ‚Äì Analisi Multi-Mercato</h3>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">‚öΩ Squadra 1</label>
                        <input type="text" class="form-control" id="calcio-squadra1" placeholder="es. Juventus" required>
                        <div class="error-message" id="calcio-squadra1-error"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">‚öΩ Squadra 2</label>
                        <input type="text" class="form-control" id="calcio-squadra2" placeholder="es. Inter" required>
                        <div class="error-message" id="calcio-squadra2-error"></div>
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label class="form-label">üéØ Tipo Pronostico Calcio</label>
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-pronostico w-100" type="button" id="dropdownCalcio" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="selected-calcio-option">ü•Ö Over/Under Gol</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-pronostico w-100" aria-labelledby="dropdownCalcio">
                        <li><h6 class="dropdown-header">üìä Mercati Partita</h6></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('over-under-gol', 'ü•Ö Over/Under Gol')">ü•Ö Over/Under Gol<br><small>0.5, 1.5, 2.5, 3.5 gol</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('doppia-chance', 'üîÑ Doppia Chance')">üîÑ Doppia Chance<br><small>1X, X2, 12</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('risultato-esatto', 'üéØ Risultato Esatto')">üéØ Risultato Esatto<br><small>1-0, 2-1, 3-2, etc.</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('gol-nogol', '‚ùå Gol/No Gol')">‚ùå Gol/No Gol<br><small>Gol, No Gol</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('both-teams', '‚öΩ Both Teams to Score')">‚öΩ Both Teams to Score<br><small>Si, No</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('pari-dispari', 'üî¢ Pari/Dispari')">üî¢ Pari/Dispari<br><small>Pari, Dispari</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('tiri-totali', 'üéØ Tiri Totali')">üéØ Tiri Totali<br><small>Over/Under tiri totali partita</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('corner', 'üìê Corner')">üìê Corner<br><small>Over/Under corner</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('cartellini', 'üü® Cartellini')">üü® Cartellini<br><small>Over/Under cartellini</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('primo-tempo', '‚è±Ô∏è Primo Tempo')">‚è±Ô∏è Primo Tempo<br><small>Risultati 1¬∞ tempo</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('vincitore', 'üèÜ Vincitore')">üèÜ Vincitore<br><small>1, X, 2</small></a></li>
                        
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header">üë§ Mercati Giocatori</h6></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('marcatore', '‚öΩ Marcatore')">‚öΩ Marcatore<br><small>Qualsiasi/Primo/Ultimo gol</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('assist', 'üéØ Assist')">üéØ Assist<br><small>Over/Under assist</small></a></li>
                    </ul>
                </div>
                <input type="hidden" id="calcio-tipo-pronostico" value="over-under-gol">
            </div>
            
            <!-- CAMPI GIOCATORE CALCIO -->
            <div id="calcio-giocatore-fields" class="giocatore-fields hidden">
                <h5 class="mb-3">üë§ Dati Giocatore</h5>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Nome Giocatore</label>
                            <input type="text" class="form-control" id="calcio-giocatore" placeholder="es. Cristiano Ronaldo">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Squadra Giocatore</label>
                            <select class="form-control" id="calcio-squadra-giocatore">
                                <option value="">Seleziona squadra</option>
                                <option value="squadra1">Squadra 1</option>
                                <option value="squadra2">Squadra 2</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üìà Media Statistica Giocatore</label>
                            <input type="number" step="0.1" class="form-control" id="calcio-media-giocatore" value="0" min="0">
                            <div class="form-text" id="calcio-media-giocatore-text">Media gol/assist del giocatore</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üî¢ Partite Analizzate</label>
                            <input type="number" step="1" class="form-control" id="calcio-partite-giocatore" value="0" min="0">
                            <div class="form-text">Numero partite considerate per la statistica</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label class="form-label">üìä Pronostico Specifico</label>
                <input type="text" class="form-control" id="calcio-pronostico" placeholder="es. Over 2.5 gol" required>
                <div class="error-message" id="calcio-pronostico-error"></div>
                <div class="form-text" id="calcio-esempi-pronostico">
                    Esempi: "Over 2.5 gol", "1X", "2-1", "Gol", "Si - Both teams to score"
                </div>
            </div>
            
            <!-- STATISTICHE AVANZATE OVER/UNDER GOL -->
            <div id="calcio-stats-overunder" class="stats-advanced">
                <div class="stats-header">ü•Ö Statistiche Over/Under Gol Avanzate</div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üìà Media Gol Fatti Squadra 1</label>
                            <input type="number" step="0.1" class="form-control" id="calcio-fatti1" value="0" min="0">
                            <div class="form-text">Media gol segnati dalla squadra 1</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üìâ Media Gol Subiti Squadra 1</label>
                            <input type="number" step="0.1" class="form-control" id="calcio-subiti1" value="0" min="0">
                            <div class="form-text">Media gol concessi dalla squadra 1</div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üìà Media Gol Fatti Squadra 2</label>
                            <input type="number" step="0.1" class="form-control" id="calcio-fatti2" value="0" min="0">
                            <div class="form-text">Media gol segnati dalla squadra 2</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üìâ Media Gol Subiti Squadra 2</label>
                            <input type="number" step="0.1" class="form-control" id="calcio-subiti2" value="0" min="0">
                            <div class="form-text">Media gol concessi dalla squadra 2</div>
                        </div>
                    </div>
                </div>
                <div id="calcio-calcolo-automatico" class="mt-3 p-3 bg-light rounded hidden">
                    <div class="stats-header">üßÆ Calcolo Automatico Media Attesa</div>
                    <div class="stats-row">
                        <span class="stats-label">Attacco Squadra 1 + Difesa Squadra 2:</span>
                        <span class="stats-value" id="calcio-attacco1-difesa2">0.0</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">Attacco Squadra 2 + Difesa Squadra 1:</span>
                        <span class="stats-value" id="calcio-attacco2-difesa1">0.0</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">üéØ Media Gol Attesa:</span>
                        <span class="stats-value" id="calcio-media-attesa" style="color: #28a745; font-size: 1.1em;">0.0</span>
                    </div>
                </div>
            </div>
            
            <!-- STATISTICHE STANDARD PER ALTRI MERCATI -->
            <div id="calcio-stats-standard" class="hidden">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üìà Media Eventi Squadra 1</label>
                            <input type="number" step="0.1" class="form-control" id="calcio-media1" value="0" min="0">
                            <div class="form-text" id="calcio-media1-text">Media eventi per la squadra 1</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">üìà Media Eventi Squadra 2</label>
                            <input type="number" step="0.1" class="form-control" id="calcio-media2" value="0" min="0">
                            <div class="form-text" id="calcio-media2-text">Media eventi per la squadra 2</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üéØ Soglia pronostico</label>
                        <input type="number" step="0.1" class="form-control" id="calcio-soglia" value="0" min="0">
                        <div class="form-text">Soglia del bookmaker (es. 2.5 per Over 2.5 gol)</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üí∞ Quota bookmaker</label>
                        <input type="number" step="0.01" class="form-control" id="calcio-quota" value="1.80" min="1.01">
                    </div>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="form-label">üìä Successi storici</label>
                <input type="text" class="form-control" id="calcio-successi" placeholder="es. 7 su 10, 65%">
                <div class="form-text">Quante volte √® successo storicamente? (es. "7/10" o "65%")</div>
            </div>
            
            <div class="d-grid gap-2">
                <button class="btn btn-primary btn-lg" onclick="analizzaCalcio()"><i class="bi bi-cpu"></i> Analisi AI Avanzata</button>
            </div>
            
            <div id="calcio-results" class="mt-4 hidden">
                <h3 class="mb-4">üìä Risultati Analisi Calcio</h3>
                
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Probabilit√†</h6>
                            <h3 id="calcio-probabilita">0%</h3>
                            <span id="calcio-prob-diff">+0.0%</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Quota Teorica</h6>
                            <h3 id="calcio-quota-teorica">0.00</h3>
                            <span id="calcio-quota-diff">+0.00</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Value Margin</h6>
                            <h3 id="calcio-value-margin">+0.0%</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Mercato</h6>
                            <h3 id="calcio-mercato">-</h3>
                            <span id="calcio-tipo">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div id="calcio-grafico-prob"></div>
                    <div id="calcio-grafico-quote"></div>
                </div>
                
                <!-- DETTAGLI ANALISI OVER/UNDER MIGLIORATA -->
                <div id="calcio-dettagli-overunder" class="card mb-4 hidden">
                    <div class="card-body">
                        <h5 class="card-title">ü•Ö Analisi Over/Under Gol Avanzata</h5>
                        <div class="stats-advanced">
                            <div class="stats-row">
                                <span class="stats-label">Squadra 1 - Attacco:</span>
                                <span class="stats-value" id="calcio-fatti1-result">0.0</span>
                            </div>
                            <div class="stats-row">
                                <span class="stats-label">Squadra 1 - Difesa:</span>
                                <span class="stats-value" id="calcio-subiti1-result">0.0</span>
                            </div>
                            <div class="stats-row">
                                <span class="stats-label">Squadra 2 - Attacco:</span>
                                <span class="stats-value" id="calcio-fatti2-result">0.0</span>
                            </div>
                            <div class="stats-row">
                                <span class="stats-label">Squadra 2 - Difesa:</span>
                                <span class="stats-value" id="calcio-subiti2-result">0.0</span>
                            </div>
                            <hr>
                            <div class="stats-row">
                                <span class="stats-label">Attacco Squadra 1 + Difesa Squadra 2:</span>
                                <span class="stats-value" id="calcio-combinazione1-result">0.0</span>
                            </div>
                            <div class="stats-row">
                                <span class="stats-label">Attacco Squadra 2 + Difesa Squadra 1:</span>
                                <span class="stats-value" id="calcio-combinazione2-result">0.0</span>
                            </div>
                            <div class="stats-row">
                                <span class="stats-label">üéØ Media Gol Attesa:</span>
                                <span class="stats-value" id="calcio-media-attesa-result" style="color: #28a745; font-size: 1.2em;">0.0</span>
                            </div>
                            <div class="stats-row">
                                <span class="stats-label">üéØ Soglia Bookmaker:</span>
                                <span class="stats-value" id="calcio-soglia-overunder-result">0.0</span>
                            </div>
                            <div class="stats-row">
                                <span class="stats-label">üìä Differenziale:</span>
                                <span class="stats-value" id="calcio-differenziale-result">+0.0</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">Dettagli Analisi</h5>
                        <p><strong>‚öΩ Match:</strong> <span id="calcio-match"></span></p>
                        <p id="calcio-giocatore-info" class="hidden"><strong>üë§ Giocatore:</strong> <span id="calcio-giocatore-result"></span> (<span id="calcio-squadra-giocatore-result"></span>)</p>
                        <p><strong>üìä Pronostico:</strong> <span id="calcio-pronostico-result"></span> <span class="tipo-pronostico" id="calcio-tipo-badge"></span></p>
                        <p id="calcio-media-giocatore-result" class="hidden"><strong>üìà Media Giocatore:</strong> <span id="calcio-media-giocatore-val"></span></p>
                        <p id="calcio-stats-standard-result" class="hidden"><strong>üìà Media Squadra 1:</strong> <span id="calcio-media1-result"></span> | <strong>Media Squadra 2:</strong> <span id="calcio-media2-result"></span></p>
                        <p><strong>üîç Metodo Analisi:</strong> <span id="calcio-metodo"></span></p>
                        <p><strong>üìä Successi Storici:</strong> <span id="calcio-successi-result"></span></p>
                    </div>
                </div>
                
                <!-- ANALISI DETTAGLIATA AI -->
                <div id="calcio-analisi-ai" class="ai-analysis-card">
                    <h4 class="text-center mb-4">üß† Analisi Dettagliata AI</h4>
                    <div id="calcio-ragionamento-ai"></div>
                </div>
                
                <div id="calcio-consiglio" class="consiglio-box"></div>
                
                <div class="d-grid gap-2 mt-3">
                    <button class="btn btn-success" onclick="salvaPronostico('calcio')"><i class="bi bi-save"></i> Salva Pronostico</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-4 mt-5">
        <p class="mb-0">Betting AI ‚Äì MultiSport Pro &copy; 2023. Supporta tutti i mercati dei bookmaker.</p>
    </footer>

    <!-- PULSANTI FISSI -->
    <button class="toggle-dark-mode" onclick="toggleDarkMode()">üåì</button>
    <button class="toggle-saved-panel" id="toggleSavedPanel"><i class="bi bi-bookmark"></i></button>
    <button class="toggle-regolamento" id="toggleRegolamento"><i class="bi bi-info-circle"></i></button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // VARIABILI GLOBALI
        let savedForecasts = [];
        let currentAnalysisData = {};
        let darkMode = localStorage.getItem('darkMode') === 'true';
        
        // INIZIALIZZAZIONE
        document.addEventListener('DOMContentLoaded', function() {
            // Carica i pronostici salvati
            try {
                const saved = localStorage.getItem('savedForecasts');
                if (saved) {
                    savedForecasts = JSON.parse(saved);
                    if (!Array.isArray(savedForecasts)) {
                        savedForecasts = [];
                    }
                } else {
                    savedForecasts = [];
                }
                
                // Imposta la modalit√† scura
                darkMode = localStorage.getItem('darkMode') === 'true';
                if (darkMode) {
                    document.body.classList.add('dark-mode');
                }
                
                // Inizializza le sezioni
                mostraSezione('basket');
                aggiornaPronosticiSalvati();
                aggiornaEsempiBasket();
                aggiornaEsempiCalcio();
                
                // Aggiunge event listeners per i pannelli
                const toggleSavedPanelBtn = document.getElementById('toggleSavedPanel');
                const closePanelBtn = document.getElementById('closePanel');
                const toggleRegolamentoBtn = document.getElementById('toggleRegolamento');
                const closeRegolamentoBtn = document.getElementById('closeRegolamento');
                const overlayEl = document.getElementById('overlay');
                
                if (toggleSavedPanelBtn) toggleSavedPanelBtn.addEventListener('click', toggleSavedPanel);
                if (closePanelBtn) closePanelBtn.addEventListener('click', closeSavedPanel);
                if (toggleRegolamentoBtn) toggleRegolamentoBtn.addEventListener('click', toggleRegolamentoPanel);
                if (closeRegolamentoBtn) closeRegolamentoBtn.addEventListener('click', closeRegolamentoPanel);
                if (overlayEl) overlayEl.addEventListener('click', function() {
                    closeSavedPanel();
                    closeRegolamentoPanel();
                });
                
                // Inizializza calcolo automatico per Over/Under
                aggiungiEventListenerCalcoloAutomatico();
                
            } catch (error) {
                console.error('Errore nell\'inizializzazione:', error);
                savedForecasts = [];
                mostraSezione('basket');
            }
        });

        // FUNZIONI BASE
        function calcolaProbabilita(num, den) {
            if (den <= 0 || isNaN(num) || isNaN(den)) {
                return 0.0;
            }
            const prob = (num / den) * 100;
            return Math.round(prob * 10) / 10;
        }

        function calcolaQuotaTeorica(prob) {
            if (prob <= 0 || isNaN(prob)) {
                return 100.0;
            }
            return Math.round(100 / prob * 100) / 100;
        }

        function mostraSezione(sport) {
            document.getElementById('basket-section').classList.add('hidden');
            document.getElementById('calcio-section').classList.add('hidden');
            document.getElementById('basket-card').classList.remove('active-sport');
            document.getElementById('calcio-card').classList.remove('active-sport');
            document.getElementById(sport + '-section').classList.remove('hidden');
            document.getElementById(sport + '-card').classList.add('active-sport');
        }

        function showSport(sport) {
            mostraSezione(sport);
        }

        // SELEZIONE PRONOSTICI BASKET
        function selezionaPronosticoBasket(tipo, testo) {
            document.getElementById('basket-tipo-pronostico').value = tipo;
            document.getElementById('selected-basket-option').textContent = testo;
            aggiornaEsempiBasket();
        }

        // SELEZIONE PRONOSTICI CALCIO
        function selezionaPronosticoCalcio(tipo, testo) {
            document.getElementById('calcio-tipo-pronostico').value = tipo;
            document.getElementById('selected-calcio-option').textContent = testo;
            
            // Mostra/nascondi campi giocatore
            const giocatoreFields = document.getElementById('calcio-giocatore-fields');
            const statsOverUnder = document.getElementById('calcio-stats-overunder');
            const statsStandard = document.getElementById('calcio-stats-standard');
            
            const tipiGiocatore = ['marcatore', 'assist'];
            const tipiOverUnder = ['over-under-gol'];
            
            // Reset visibilit√†
            giocatoreFields.classList.add('hidden');
            statsOverUnder.classList.add('hidden');
            statsStandard.classList.add('hidden');
            
            if (tipiGiocatore.includes(tipo)) {
                giocatoreFields.classList.remove('hidden');
            } else if (tipiOverUnder.includes(tipo)) {
                statsOverUnder.classList.remove('hidden');
            } else {
                statsStandard.classList.remove('hidden');
            }
            
            aggiornaEsempiCalcio();
        }

        // AGGIORNA ESEMPI
        function aggiornaEsempiBasket() {
            var tipo = document.getElementById('basket-tipo-pronostico').value;
            var esempiElement = document.getElementById('basket-esempi-pronostico');
            
            switch(tipo) {
                case 'punti-over-under':
                    esempiElement.textContent = 'Esempi: "Over 27.5 punti", "Under 25.5 punti", "Over 30.5 punti"';
                    break;
                case 'rimbalzi-over-under':
                    esempiElement.textContent = 'Esempi: "Over 9.5 rimbalzi", "Under 11.5 rimbalzi", "Over 10.5 rimbalzi"';
                    break;
                case 'assist-over-under':
                    esempiElement.textContent = 'Esempi: "Over 9.5 assist", "Under 8.5 assist", "Over 10.5 assist"';
                    break;
                case 'performance-multipla':
                    esempiElement.textContent = 'Esempi: "Over 40.5 P+R+A", "Under 45.5 P+R+A", "Over 50.5 P+R+A"';
                    break;
                case 'vincitore':
                    esempiElement.textContent = 'Esempi: "1", "2", "X"';
                    break;
                case 'handicap':
                    esempiElement.textContent = 'Esempi: "Squadra 1 -5.5", "Squadra 2 +3.5"';
                    break;
                case 'punti-totali':
                    esempiElement.textContent = 'Esempi: "Over 220.5 punti totali", "Under 215.5 punti totali"';
                    break;
                case 'custom':
                    esempiElement.textContent = 'Inserisci qualsiasi pronostico personalizzato per il basket';
                    break;
            }
        }

        function aggiornaEsempiCalcio() {
            var tipo = document.getElementById('calcio-tipo-pronostico').value;
            var esempiElement = document.getElementById('calcio-esempi-pronostico');
            
            switch(tipo) {
                case 'over-under-gol':
                    esempiElement.textContent = 'Esempi: "Over 2.5 gol", "Under 3.5 gol", "Over 1.5 gol"';
                    break;
                case 'doppia-chance':
                    esempiElement.textContent = 'Esempi: "1X", "X2", "12"';
                    break;
                case 'risultato-esatto':
                    esempiElement.textContent = 'Esempi: "2-1", "1-1", "3-0", "0-2"';
                    break;
                case 'gol-nogol':
                    esempiElement.textContent = 'Esempi: "Gol", "No Gol"';
                    break;
                case 'both-teams':
                    esempiElement.textContent = 'Esempi: "Si - Both teams to score", "No - Both teams to score"';
                    break;
                case 'pari-dispari':
                    esempiElement.textContent = 'Esempi: "Pari", "Dispari"';
                    break;
                case 'tiri-totali':
                    esempiElement.textContent = 'Esempi: "Over 9.5 tiri totali", "Under 8.5 tiri totali", "Over 10.5 tiri totali"';
                    break;
                case 'corner':
                    esempiElement.textContent = 'Esempi: "Over 9.5 corner", "Under 8.5 corner", "Over 10.5 corner"';
                    break;
                case 'cartellini':
                    esempiElement.textContent = 'Esempi: "Over 4.5 cartellini", "Under 3.5 cartellini", "Over 5.5 cartellini"';
                    break;
                case 'primo-tempo':
                    esempiElement.textContent = 'Esempi: "1 primo tempo", "X primo tempo", "2 primo tempo"';
                    break;
                case 'vincitore':
                    esempiElement.textContent = 'Esempi: "1", "X", "2"';
                    break;
                case 'marcatore':
                    esempiElement.textContent = 'Esempi: "Cristiano Ronaldo marcatore", "Messi primo gol", "Haaland ultimo gol"';
                    break;
                case 'assist':
                    esempiElement.textContent = 'Esempi: "Kevin De Bruyne Over 0.5 assist", "Bruno Fernandes Under 1.5 assist"';
                    break;
            }
        }

        // CALCOLO AUTOMATICO MEDIA ATTESA OVER/UNDER
        function aggiungiEventListenerCalcoloAutomatico() {
            const inputs = ['calcio-fatti1', 'calcio-subiti1', 'calcio-fatti2', 'calcio-subiti2'];
            
            inputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', calcolaMediaAttesa);
                }
            });
            
            // Calcola subito con i valori attuali
            calcolaMediaAttesa();
        }

        function calcolaMediaAttesa() {
            const fatti1 = parseFloat(document.getElementById('calcio-fatti1').value) || 0;
            const subiti1 = parseFloat(document.getElementById('calcio-subiti1').value) || 0;
            const fatti2 = parseFloat(document.getElementById('calcio-fatti2').value) || 0;
            const subiti2 = parseFloat(document.getElementById('calcio-subiti2').value) || 0;
            
            const combinazione1 = (fatti1 + subiti2) / 2;
            const combinazione2 = (fatti2 + subiti1) / 2;
            const mediaAttesa = (combinazione1 + combinazione2) / 2;
            
            const calcoloContainer = document.getElementById('calcio-calcolo-automatico');
            
            if (fatti1 > 0 || subiti1 > 0 || fatti2 > 0 || subiti2 > 0) {
                calcoloContainer.classList.remove('hidden');
                
                document.getElementById('calcio-attacco1-difesa2').textContent = combinazione1.toFixed(2);
                document.getElementById('calcio-attacco2-difesa1').textContent = combinazione2.toFixed(2);
                document.getElementById('calcio-media-attesa').textContent = mediaAttesa.toFixed(2);
                
                // Colore in base al valore
                const mediaElement = document.getElementById('calcio-media-attesa');
                if (mediaAttesa >= 3.0) {
                    mediaElement.style.color = '#dc3545';
                } else if (mediaAttesa >= 2.0) {
                    mediaElement.style.color = '#28a745';
                } else {
                    mediaElement.style.color = '#6c757d';
                }
            } else {
                calcoloContainer.classList.add('hidden');
            }
        }

        // VALIDAZIONE
        function validaCampi(sport) {
            var valid = true;
            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            
            var squadra1 = document.getElementById(sport + '-squadra1').value;
            var squadra2 = document.getElementById(sport + '-squadra2').value;
            var pronostico = document.getElementById(sport + '-pronostico').value;
            
            if (!squadra1 || squadra1.trim() === '') {
                document.getElementById(sport + '-squadra1-error').textContent = 'Campo obbligatorio';
                valid = false;
            }
            if (!squadra2 || squadra2.trim() === '') {
                document.getElementById(sport + '-squadra2-error').textContent = 'Campo obbligatorio';
                valid = false;
            }
            if (!pronostico || pronostico.trim() === '') {
                document.getElementById(sport + '-pronostico-error').textContent = 'Campo obbligatorio';
                valid = false;
            }
            
            // Validazione specifica per basket
            if (sport === 'basket') {
                const giocatore = document.getElementById('basket-giocatore').value;
                const squadraGiocatore = document.getElementById('basket-squadra-giocatore').value;
                
                if (!giocatore || giocatore.trim() === '') {
                    document.getElementById('basket-giocatore-error').textContent = 'Campo obbligatorio';
                    valid = false;
                }
                if (!squadraGiocatore) {
                    document.getElementById('basket-squadra-giocatore-error').textContent = 'Seleziona una squadra';
                    valid = false;
                }
            }
            
            return valid;
        }

        // ANALISI BASKET
        function analizzaBasket() {
            if (!validaCampi('basket')) {
                alert('‚ùå Compila tutti i campi obbligatori!');
                return;
            }
            
            var squadra1 = document.getElementById('basket-squadra1').value;
            var squadra2 = document.getElementById('basket-squadra2').value;
            var giocatore = document.getElementById('basket-giocatore').value;
            var squadraGiocatore = document.getElementById('basket-squadra-giocatore').value;
            var pronostico = document.getElementById('basket-pronostico').value;
            var totale = parseFloat(document.getElementById('basket-totale').value) || 0;
            var eventi = parseInt(document.getElementById('basket-eventi').value) || 0;
            var soglia = parseFloat(document.getElementById('basket-soglia').value) || 0;
            var quota = parseFloat(document.getElementById('basket-quota').value) || 1.80;
            var successi = document.getElementById('basket-successi').value;
            var tipoPronostico = document.getElementById('basket-tipo-pronostico').value;
            
            try {
                var media = eventi > 0 ? Math.round((totale / eventi) * 100) / 100 : 0.0;
                var prob, successiTxt, metodo;
                
                if (successi && successi.includes("su") && successi.trim()) {
                    var parts = successi.split("su");
                    var n = parseInt(parts[0]);
                    var d = parseInt(parts[1]);
                    prob = calcolaProbabilita(n, d);
                    successiTxt = n + " su " + d;
                    metodo = "üìä DATI STORICI";
                } else if (successi && successi.includes("%")) {
                    prob = parseFloat(successi.replace('%', ''));
                    successiTxt = successi;
                    metodo = "üìä DATI STORICI";
                } else {
                    if (media > 0 && soglia > 0) {
                        if (pronostico.toLowerCase().includes("over")) {
                            prob = Math.min(80, 50 + (media - soglia) * 8);
                        } else if (pronostico.toLowerCase().includes("under")) {
                            prob = Math.max(20, 50 - (soglia - media) * 8);
                        } else {
                            prob = 50.0;
                        }
                    } else {
                        prob = 50.0;
                    }
                    successiTxt = "Stimato da media statistica";
                    metodo = "ü§ñ STIMA AI";
                }
                
                var quotaTeo = calcolaQuotaTeorica(prob);
                var valueMargin = quotaTeo > 0 ? ((quota / quotaTeo) - 1) * 100 : 0;
                
                // AGGIORNA RISULTATI
                document.getElementById('basket-probabilita').textContent = prob + '%';
                document.getElementById('basket-prob-diff').textContent = (prob - 50 >= 0 ? '+' : '') + (prob - 50).toFixed(1) + '%';
                document.getElementById('basket-prob-diff').className = (prob - 50 >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('basket-quota-teorica').textContent = quotaTeo.toFixed(2);
                document.getElementById('basket-quota-diff').textContent = (quotaTeo - quota >= 0 ? '+' : '') + (quotaTeo - quota).toFixed(2);
                document.getElementById('basket-quota-diff').className = (quotaTeo - quota >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('basket-value-margin').textContent = (valueMargin >= 0 ? '+' : '') + valueMargin.toFixed(1) + '%';
                document.getElementById('basket-value-margin').className = (valueMargin >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('basket-match').textContent = squadra1 + ' vs ' + squadra2;
                document.getElementById('basket-giocatore-result').textContent = giocatore;
                document.getElementById('basket-squadra-giocatore-result').textContent = squadraGiocatore === 'squadra1' ? squadra1 : squadra2;
                document.getElementById('basket-pronostico-result').textContent = pronostico;
                document.getElementById('basket-media').textContent = media;
                document.getElementById('basket-soglia-result').textContent = soglia;
                document.getElementById('basket-metodo').textContent = metodo;
                document.getElementById('basket-successi-result').textContent = successiTxt;
                
                // Aggiorna tipo mercato
                var tipoTesto = getTipoPronosticoTesto(tipoPronostico);
                document.getElementById('basket-mercato').textContent = tipoTesto.mercato;
                document.getElementById('basket-tipo').textContent = tipoTesto.tipo;
                document.getElementById('basket-tipo-badge').textContent = tipoTesto.badge;
                
                // CREA GRAFICI
                creaGraficoAnalisi(prob, quota, quotaTeo, "Basket", "basket-grafico");
                
                // GENERA ANALISI AI
                var analisiDettagliata = generaAnalisiDettagliataAI('basket', pronostico, media, soglia, prob, quota, quotaTeo, valueMargin, successiTxt, metodo);
                document.getElementById('basket-ragionamento-ai').innerHTML = analisiDettagliata;
                
                // GENERA CONSIGLIO
                var consiglio = analisiAvanzataAI(pronostico, media, soglia, prob, quota, quotaTeo);
                document.getElementById('basket-consiglio').innerHTML = consiglio;
                
                // SALVA I DATI DELL'ANALISI CORRENTE
                currentAnalysisData = {
                    sport: 'basket',
                    squadra1: squadra1,
                    squadra2: squadra2,
                    giocatore: giocatore,
                    squadraGiocatore: squadraGiocatore,
                    pronostico: pronostico,
                    media: media,
                    soglia: soglia,
                    prob: prob,
                    quota: quota,
                    quotaTeo: quotaTeo,
                    valueMargin: valueMargin,
                    successiTxt: successiTxt,
                    metodo: metodo,
                    tipoPronostico: tipoPronostico,
                    analisiDettagliata: analisiDettagliata,
                    consiglio: consiglio
                };
                
                // MOSTRA RISULTATI
                document.getElementById('basket-results').classList.remove('hidden');
                
            } catch (e) {
                alert("‚ùå Errore nel calcolo: " + e.message);
            }
        }

        // ANALISI CALCIO
        function analizzaCalcio() {
            if (!validaCampi('calcio')) {
                alert('‚ùå Compila tutti i campi obbligatori!');
                return;
            }
            
            var squadra1 = document.getElementById('calcio-squadra1').value;
            var squadra2 = document.getElementById('calcio-squadra2').value;
            var pronostico = document.getElementById('calcio-pronostico').value;
            var soglia = parseFloat(document.getElementById('calcio-soglia').value) || 0;
            var quota = parseFloat(document.getElementById('calcio-quota').value) || 1.80;
            var successi = document.getElementById('calcio-successi').value;
            var tipoPronostico = document.getElementById('calcio-tipo-pronostico').value;
            
            try {
                var media, prob, successiTxt, metodo;
                var isOverUnderGol = tipoPronostico === 'over-under-gol';
                var isMercatoGiocatore = ['marcatore', 'assist'].includes(tipoPronostico);
                
                if (isOverUnderGol) {
                    // Over/Under Gol - usa statistiche avanzate
                    var fatti1 = parseFloat(document.getElementById('calcio-fatti1').value) || 0;
                    var subiti1 = parseFloat(document.getElementById('calcio-subiti1').value) || 0;
                    var fatti2 = parseFloat(document.getElementById('calcio-fatti2').value) || 0;
                    var subiti2 = parseFloat(document.getElementById('calcio-subiti2').value) || 0;
                    
                    const combinazione1 = (fatti1 + subiti2) / 2;
                    const combinazione2 = (fatti2 + subiti1) / 2;
                    media = (combinazione1 + combinazione2) / 2;
                    
                    // Mostra dettagli Over/Under avanzati
                    document.getElementById('calcio-dettagli-overunder').classList.remove('hidden');
                    
                    // Aggiorna dettagli Over/Under
                    document.getElementById('calcio-fatti1-result').textContent = fatti1.toFixed(2);
                    document.getElementById('calcio-subiti1-result').textContent = subiti1.toFixed(2);
                    document.getElementById('calcio-fatti2-result').textContent = fatti2.toFixed(2);
                    document.getElementById('calcio-subiti2-result').textContent = subiti2.toFixed(2);
                    document.getElementById('calcio-combinazione1-result').textContent = combinazione1.toFixed(2);
                    document.getElementById('calcio-combinazione2-result').textContent = combinazione2.toFixed(2);
                    document.getElementById('calcio-media-attesa-result').textContent = media.toFixed(2);
                    document.getElementById('calcio-soglia-overunder-result').textContent = soglia.toFixed(2);
                    
                    const differenziale = media - soglia;
                    document.getElementById('calcio-differenziale-result').textContent = (differenziale >= 0 ? '+' : '') + differenziale.toFixed(2);
                    document.getElementById('calcio-differenziale-result').style.color = differenziale >= 0 ? '#28a745' : '#dc3545';
                    
                } else if (isMercatoGiocatore) {
                    // Mercati giocatore
                    var mediaGiocatore = parseFloat(document.getElementById('calcio-media-giocatore').value) || 0;
                    media = mediaGiocatore;
                    
                    // Mostra info giocatore
                    document.getElementById('calcio-giocatore-info').classList.remove('hidden');
                    document.getElementById('calcio-media-giocatore-result').classList.remove('hidden');
                    
                    var giocatore = document.getElementById('calcio-giocatore').value;
                    var squadraGiocatore = document.getElementById('calcio-squadra-giocatore').value;
                    var nomeSquadra = squadraGiocatore === 'squadra1' ? squadra1 : squadra2;
                    
                    document.getElementById('calcio-giocatore-result').textContent = giocatore;
                    document.getElementById('calcio-squadra-giocatore-result').textContent = nomeSquadra;
                    document.getElementById('calcio-media-giocatore-val').textContent = mediaGiocatore;
                    
                    document.getElementById('calcio-dettagli-overunder').classList.add('hidden');
                } else {
                    // Altri mercati
                    media = 50.0;
                    document.getElementById('calcio-dettagli-overunder').classList.add('hidden');
                    document.getElementById('calcio-giocatore-info').classList.add('hidden');
                    document.getElementById('calcio-media-giocatore-result').classList.add('hidden');
                }
                
                // CALCOLO PROBABILIT√Ä
                if (successi && successi.includes("su") && successi.trim()) {
                    var parts = successi.split("su");
                    var n = parseInt(parts[0]);
                    var d = parseInt(parts[1]);
                    prob = calcolaProbabilita(n, d);
                    successiTxt = n + " su " + d;
                    metodo = "üìä DATI STORICI";
                } else if (successi && successi.includes("%")) {
                    prob = parseFloat(successi.replace('%', ''));
                    successiTxt = successi;
                    metodo = "üìä DATI STORICI";
                } else {
                    if ((isOverUnderGol || isMercatoGiocatore) && media > 0 && soglia > 0) {
                        if (pronostico.toLowerCase().includes("over")) {
                            prob = Math.min(75, 50 + (media - soglia) * 10);
                        } else if (pronostico.toLowerCase().includes("under")) {
                            prob = Math.max(25, 50 - (soglia - media) * 10);
                        } else {
                            prob = 50.0;
                        }
                    } else {
                        prob = 50.0;
                    }
                    successiTxt = isOverUnderGol ? "Stimato da analisi attacco/difesa" : 
                                  isMercatoGiocatore ? "Stimato da statistiche giocatore" : 
                                  "Stimato da dati generici";
                    metodo = "ü§ñ STIMA AI";
                }
                
                var quotaTeo = calcolaQuotaTeorica(prob);
                var valueMargin = quotaTeo > 0 ? ((quota / quotaTeo) - 1) * 100 : 0;
                
                // AGGIORNA RISULTATI
                document.getElementById('calcio-probabilita').textContent = prob + '%';
                document.getElementById('calcio-prob-diff').textContent = (prob - 50 >= 0 ? '+' : '') + (prob - 50).toFixed(1) + '%';
                document.getElementById('calcio-prob-diff').className = (prob - 50 >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('calcio-quota-teorica').textContent = quotaTeo.toFixed(2);
                document.getElementById('calcio-quota-diff').textContent = (quotaTeo - quota >= 0 ? '+' : '') + (quotaTeo - quota).toFixed(2);
                document.getElementById('calcio-quota-diff').className = (quotaTeo - quota >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('calcio-value-margin').textContent = (valueMargin >= 0 ? '+' : '') + valueMargin.toFixed(1) + '%';
                document.getElementById('calcio-value-margin').className = (valueMargin >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('calcio-match').textContent = squadra1 + ' vs ' + squadra2;
                document.getElementById('calcio-pronostico-result').textContent = pronostico;
                document.getElementById('calcio-metodo').textContent = metodo;
                document.getElementById('calcio-successi-result').textContent = successiTxt;
                
                // Aggiorna tipo mercato
                var tipoTesto = getTipoPronosticoTesto(tipoPronostico);
                document.getElementById('calcio-mercato').textContent = tipoTesto.mercato;
                document.getElementById('calcio-tipo').textContent = tipoTesto.tipo;
                document.getElementById('calcio-tipo-badge').textContent = tipoTesto.badge;
                
                // CREA GRAFICI
                creaGraficoAnalisi(prob, quota, quotaTeo, "Calcio", "calcio-grafico");
                
                // GENERA ANALISI AI
                var analisiDettagliata = generaAnalisiDettagliataAI('calcio', pronostico, media, soglia, prob, quota, quotaTeo, valueMargin, successiTxt, metodo);
                document.getElementById('calcio-ragionamento-ai').innerHTML = analisiDettagliata;
                
                // GENERA CONSIGLIO
                var consiglio = analisiAvanzataAI(pronostico, media, soglia, prob, quota, quotaTeo);
                document.getElementById('calcio-consiglio').innerHTML = consiglio;
                
                // SALVA I DATI DELL'ANALISI CORRENTE
                currentAnalysisData = {
                    sport: 'calcio',
                    squadra1: squadra1,
                    squadra2: squadra2,
                    pronostico: pronostico,
                    media: media,
                    soglia: soglia,
                    prob: prob,
                    quota: quota,
                    quotaTeo: quotaTeo,
                    valueMargin: valueMargin,
                    successiTxt: successiTxt,
                    metodo: metodo,
                    tipoPronostico: tipoPronostico,
                    analisiDettagliata: analisiDettagliata,
                    consiglio: consiglio,
                    isOverUnderGol: isOverUnderGol,
                    isMercatoGiocatore: isMercatoGiocatore
                };
                
                if (isOverUnderGol) {
                    currentAnalysisData.fatti1 = parseFloat(document.getElementById('calcio-fatti1').value) || 0;
                    currentAnalysisData.subiti1 = parseFloat(document.getElementById('calcio-subiti1').value) || 0;
                    currentAnalysisData.fatti2 = parseFloat(document.getElementById('calcio-fatti2').value) || 0;
                    currentAnalysisData.subiti2 = parseFloat(document.getElementById('calcio-subiti2').value) || 0;
                }
                
                if (isMercatoGiocatore) {
                    currentAnalysisData.giocatore = document.getElementById('calcio-giocatore').value;
                    currentAnalysisData.squadraGiocatore = document.getElementById('calcio-squadra-giocatore').value;
                    currentAnalysisData.mediaGiocatore = parseFloat(document.getElementById('calcio-media-giocatore').value) || 0;
                }
                
                // MOSTRA RISULTATI
                document.getElementById('calcio-results').classList.remove('hidden');
                
            } catch (e) {
                alert("‚ùå Errore nel calcolo: " + e.message);
            }
        }

        // FUNZIONE PER CREARE GRAFICI
        function creaGraficoAnalisi(prob, quota, quotaTeo, sport, containerId) {
            // Distruggi i grafici esistenti
            const probContainer = document.getElementById(containerId + '-prob');
            const quoteContainer = document.getElementById(containerId + '-quote');
            
            if (probContainer) {
                Plotly.purge(containerId + '-prob');
            }
            if (quoteContainer) {
                Plotly.purge(containerId + '-quote');
            }
            
            var indicatorData = {
                type: "indicator",
                mode: "gauge+number+delta",
                value: prob,
                domain: { x: [0, 1], y: [0, 1] },
                title: { text: "Probabilit√† %" },
                delta: { reference: 50 },
                gauge: {
                    axis: { range: [null, 100] },
                    bar: { color: "darkblue" },
                    steps: [
                        { range: [0, 40], color: "lightgray" },
                        { range: [40, 60], color: "yellow" },
                        { range: [60, 100], color: "green" }
                    ],
                    threshold: {
                        line: { color: "red", width: 4 },
                        thickness: 0.75,
                        value: 60
                    }
                }
            };

            var barData = {
                type: "bar",
                x: ['Quota Teorica', 'Quota Bookmaker'],
                y: [quotaTeo, quota],
                marker: {
                    color: ['lightblue', 'darkblue']
                },
                text: [quotaTeo.toFixed(2), quota.toFixed(2)],
                textposition: 'auto'
            };

            var indicatorLayout = {
                title: `Probabilit√† ${sport}`,
                height: 400
            };

            var barLayout = {
                title: `Confronto Quote ${sport}`,
                height: 400
            };

            Plotly.newPlot(containerId + '-prob', [indicatorData], indicatorLayout);
            Plotly.newPlot(containerId + '-quote', [barData], barLayout);
        }

        // FUNZIONE PER ANALISI AVANZATA AI
        function analisiAvanzataAI(esito, media, soglia, prob, quota, quotaTeo) {
            var valueMargin = quotaTeo > 0 ? ((quota / quotaTeo) - 1) * 100 : 0;
            
            if (esito.toLowerCase().includes("over")) {
                var confidenceScore = 0;
                
                if (media > soglia * 1.2) {
                    confidenceScore += 40;
                } else if (media > soglia) {
                    confidenceScore += 20;
                } else if (media > soglia * 0.9) {
                    confidenceScore += 10;
                }
                
                if (prob > 70) {
                    confidenceScore += 30;
                } else if (prob > 60) {
                    confidenceScore += 20;
                } else if (prob > 50) {
                    confidenceScore += 10;
                }
                
                if (valueMargin > 20) {
                    confidenceScore += 20;
                } else if (valueMargin > 10) {
                    confidenceScore += 10;
                } else if (valueMargin > 0) {
                    confidenceScore += 5;
                }
                
                if (media > soglia && prob > 60) {
                    confidenceScore += 10;
                }
                
                return generaConsiglioFinale("OVER", confidenceScore, valueMargin, prob);
            } else if (esito.toLowerCase().includes("under")) {
                var confidenceScore = 0;
                
                if (media < soglia * 0.8) {
                    confidenceScore += 40;
                } else if (media < soglia) {
                    confidenceScore += 20;
                } else if (media < soglia * 1.1) {
                    confidenceScore += 10;
                }
                
                if (prob > 70) {
                    confidenceScore += 30;
                } else if (prob > 60) {
                    confidenceScore += 20;
                } else if (prob > 50) {
                    confidenceScore += 10;
                }
                
                if (valueMargin > 20) {
                    confidenceScore += 20;
                } else if (valueMargin > 10) {
                    confidenceScore += 10;
                } else if (valueMargin > 0) {
                    confidenceScore += 5;
                }
                
                if (media < soglia && prob > 60) {
                    confidenceScore += 10;
                }
                
                return generaConsiglioFinale("UNDER", confidenceScore, valueMargin, prob);
            } else {
                var confidenceScore = 0;
                
                if (prob > 70) {
                    confidenceScore += 50;
                } else if (prob > 60) {
                    confidenceScore += 35;
                } else if (prob > 55) {
                    confidenceScore += 20;
                } else if (prob > 50) {
                    confidenceScore += 10;
                }
                
                if (valueMargin > 15) {
                    confidenceScore += 25;
                } else if (valueMargin > 5) {
                    confidenceScore += 15;
                } else if (valueMargin > 0) {
                    confidenceScore += 5;
                }
                
                return generaConsiglioFinale(esito.toUpperCase(), confidenceScore, valueMargin, prob);
            }
        }

        function generaConsiglioFinale(tipoScommessa, confidenceScore, valueMargin, prob) {
            if (confidenceScore >= 80) {
                return `<div class="success-card">
                    <h5>üöÄ <strong>FORTE RACCOMANDAZIONE ${tipoScommessa}</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>üéØ L'AI √® molto fiduciosa in questa scommessa!</p>
                </div>`;
            } else if (confidenceScore >= 60) {
                return `<div class="warning-card">
                    <h5>‚úÖ <strong>CONSIGLIO ${tipoScommessa}</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>üëç Buona opportunit√† secondo l'analisi AI.</p>
                </div>`;
            } else if (confidenceScore >= 40) {
                return `<div class="warning-card">
                    <h5>‚ö†Ô∏è <strong>${tipoScommessa} CON PRUDENZA</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>ü§î Possibile ma rischiosa. Considera stake ridotto.</p>
                </div>`;
            } else {
                return `<div class="danger-card">
                    <h5>‚ùå <strong>SCONSIGLIO ${tipoScommessa}</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>üö´ I dati non supportano questa scommessa.</p>
                </div>`;
            }
        }

        // FUNZIONE PER ANALISI DETTAGLIATA AI
        function generaAnalisiDettagliataAI(sport, pronostico, media, soglia, prob, quota, quotaTeo, valueMargin, successi, metodo) {
            var analisiHTML = '';
            var ragionamenti = [];
            
            // Analisi basata sul tipo di pronostico
            if (pronostico.toLowerCase().includes("over")) {
                ragionamenti.push({
                    tipo: media > soglia ? "positive" : "negative",
                    testo: `üìà <strong>Media vs Soglia:</strong> La media (${media.toFixed(2)}) √® ${media > soglia ? 'superiore' : 'inferiore'} alla soglia (${soglia}) - ${media > soglia ? 'favorevole per OVER' : 'sfavorevole per OVER'}`
                });
            } else if (pronostico.toLowerCase().includes("under")) {
                ragionamenti.push({
                    tipo: media < soglia ? "positive" : "negative",
                    testo: `üìâ <strong>Media vs Soglia:</strong> La media (${media.toFixed(2)}) √® ${media < soglia ? 'inferiore' : 'superiore'} alla soglia (${soglia}) - ${media < soglia ? 'favorevole per UNDER' : 'sfavorevole per UNDER'}`
                });
            }

            // Analisi probabilit√†
            if (prob >= 70) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üé≤ <strong>Alta Probabilit√†:</strong> ${prob}% di successo - livello di confidenza molto alto`
                });
            } else if (prob >= 60) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `‚úÖ <strong>Buona Probabilit√†:</strong> ${prob}% di successo - livello di confidenza solido`
                });
            } else if (prob >= 50) {
                ragionamenti.push({
                    tipo: "warning",
                    testo: `‚öñÔ∏è <strong>Probabilit√† Equilibrata:</strong> ${prob}% di successo - situazione bilanciata`
                });
            } else {
                ragionamenti.push({
                    tipo: "negative",
                    testo: `üìä <strong>Probabilit√† Bassa:</strong> Solo ${prob}% di successo - rischio significativo`
                });
            }

            // Analisi value bet
            if (valueMargin > 15) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üí∞ <strong>Value Bet Eccellente:</strong> +${valueMargin.toFixed(1)}% di valore - opportunit√† rara`
                });
            } else if (valueMargin > 5) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üíµ <strong>Buon Value Bet:</strong> +${valueMargin.toFixed(1)}% di valore - situazione favorevole`
                });
            } else if (valueMargin > 0) {
                ragionamenti.push({
                    tipo: "warning",
                    testo: `üìä <strong>Value Bet Limitato:</strong> +${valueMargin.toFixed(1)}% di valore - margine ridotto`
                });
            } else {
                ragionamenti.push({
                    tipo: "negative",
                    testo: `‚ùå <strong>Nessun Value Bet:</strong> ${valueMargin.toFixed(1)}% di valore - quota bookmaker non conveniente`
                });
            }

            // Analisi dati storici
            if (metodo.includes("STORICI")) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üìö <strong>Dati Storici Solidi:</strong> Analisi basata su ${successi} - fondamento statistico robusto`
                });
            } else {
                ragionamenti.push({
                    tipo: "warning",
                    testo: `ü§ñ <strong>Stima AI:</strong> Probabilit√† calcolata algoritmicamente - attendibilit√† variabile`
                });
            }

            // Costruisci HTML
            ragionamenti.forEach(rag => {
                var classe = rag.tipo === "positive" ? "reason-item" : 
                            rag.tipo === "warning" ? "reason-item warning-reason" : 
                            "reason-item danger-reason";
                analisiHTML += `<div class="${classe}">${rag.testo}</div>`;
            });

            // Conclusione
            var conclusione = '';
            if (prob >= 70 && valueMargin > 10) {
                conclusione = `üéØ <strong>CONCLUSIONE AI:</strong> Combinazione eccellente di alta probabilit√† (${prob}%) e forte value bet (+${valueMargin.toFixed(1)}%). L'AI raccomanda fortemente questa scommessa.`;
            } else if (prob >= 60 && valueMargin > 5) {
                conclusione = `‚úÖ <strong>CONCLUSIONE AI:</strong> Buon bilanciamento tra probabilit√† (${prob}%) e valore (+${valueMargin.toFixed(1)}%). Scommessa consigliata con moderazione.`;
            } else if (prob >= 50 && valueMargin > 0) {
                conclusione = `‚öñÔ∏è <strong>CONCLUSIONE AI:</strong> Situazione equilibrata. Probabilit√† (${prob}%) e valore (+${valueMargin.toFixed(1)}%) sufficienti per considerare la scommessa.`;
            } else {
                conclusione = `‚ö†Ô∏è <strong>CONCLUSIONE AI:</strong> Fattori di rischio elevati. Probabilit√† (${prob}%) e valore (+${valueMargin.toFixed(1)}%) insufficienti per una raccomandazione.`;
            }

            analisiHTML += `<div class="reason-item" style="background: rgba(255,255,255,0.2); border-left-color: #2196F3;">${conclusione}</div>`;

            return analisiHTML;
        }

        // FUNZIONE PER OTTENERE TIPO PRONOSTICO
        function getTipoPronosticoTesto(tipo) {
            const tipi = {
                // Basket
                'punti-over-under': { mercato: 'Punti', tipo: 'O/U Giocatore', badge: 'üèÄ Punti' },
                'rimbalzi-over-under': { mercato: 'Rimbalzi', tipo: 'O/U Giocatore', badge: 'üìà Rimbalzi' },
                'assist-over-under': { mercato: 'Assist', tipo: 'O/U Giocatore', badge: 'üéØ Assist' },
                'performance-multipla': { mercato: 'Performance', tipo: 'Multipla', badge: '‚≠ê Performance' },
                'vincitore': { mercato: 'Vincitore', tipo: '1/X/2', badge: 'üèÜ Vincitore' },
                'handicap': { mercato: 'Handicap', tipo: 'Punti', badge: '‚öñÔ∏è Handicap' },
                'punti-totali': { mercato: 'Punti Totali', tipo: 'O/U Partita', badge: 'üî¢ P.Totali' },
                'custom': { mercato: 'Personalizzato', tipo: 'Vari', badge: '‚úèÔ∏è Custom' },
                // Calcio
                'over-under-gol': { mercato: 'O/U Gol', tipo: 'Gol', badge: 'ü•Ö O/U Gol' },
                'doppia-chance': { mercato: 'Doppia Chance', tipo: '1X/X2/12', badge: 'üîÑ D.Chance' },
                'risultato-esatto': { mercato: 'Ris. Esatto', tipo: 'Score', badge: 'üéØ R.Esatto' },
                'gol-nogol': { mercato: 'Gol/No Gol', tipo: 'G/NG', badge: '‚ùå G/NG' },
                'both-teams': { mercato: 'BTTS', tipo: 'Si/No', badge: '‚öΩ BTTS' },
                'pari-dispari': { mercato: 'Pari/Dispari', tipo: 'P/D', badge: 'üî¢ P/D' },
                'tiri-totali': { mercato: 'Tiri Totali', tipo: 'O/U', badge: 'üéØ Tiri Totali' },
                'corner': { mercato: 'Corner', tipo: 'O/U', badge: 'üìê Corner' },
                'cartellini': { mercato: 'Cartellini', tipo: 'O/U', badge: 'üü® Cartellini' },
                'primo-tempo': { mercato: '1¬∞ Tempo', tipo: 'Parziale', badge: '‚è±Ô∏è 1¬∞T' },
                'vincitore': { mercato: 'Vincitore', tipo: '1/X/2', badge: 'üèÜ Vincitore' },
                'marcatore': { mercato: 'Marcatore', tipo: 'Giocatore', badge: '‚öΩ Marcatore' },
                'assist': { mercato: 'Assist', tipo: 'Giocatore', badge: 'üéØ Assist' }
            };
            return tipi[tipo] || { mercato: 'Mercato', tipo: 'Tipo', badge: 'üìä' };
        }

        // FUNZIONI PER I PANNELLI
        function toggleSavedPanel() {
            const panel = document.getElementById('savedPanel');
            const overlay = document.getElementById('overlay');
            
            panel.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeSavedPanel() {
            const panel = document.getElementById('savedPanel');
            const overlay = document.getElementById('overlay');
            
            panel.classList.remove('open');
            overlay.classList.remove('active');
        }

        function toggleRegolamentoPanel() {
            const panel = document.getElementById('regolamentoPanel');
            const overlay = document.getElementById('overlay');
            
            panel.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeRegolamentoPanel() {
            const panel = document.getElementById('regolamentoPanel');
            const overlay = document.getElementById('overlay');
            
            panel.classList.remove('open');
            overlay.classList.remove('active');
        }

        function toggleDarkMode() {
            darkMode = !darkMode;
            document.body.classList.toggle('dark-mode', darkMode);
            localStorage.setItem('darkMode', darkMode);
        }

        // FUNZIONE PER SALVARE PRONOSTICO
        function salvaPronostico(sport) {
            if (!currentAnalysisData || Object.keys(currentAnalysisData).length === 0) {
                alert('‚ùå Prima devi effettuare un\'analisi per salvare il pronostico!');
                return;
            }
            
            const forecast = {
                id: Date.now(),
                sport: sport,
                squadra1: currentAnalysisData.squadra1,
                squadra2: currentAnalysisData.squadra2,
                pronostico: currentAnalysisData.pronostico,
                probabilita: currentAnalysisData.prob + '%',
                quotaTeorica: currentAnalysisData.quotaTeo.toFixed(2),
                valueMargin: (currentAnalysisData.valueMargin >= 0 ? '+' : '') + currentAnalysisData.valueMargin.toFixed(1) + '%',
                mercato: getTipoPronosticoTesto(currentAnalysisData.tipoPronostico).mercato,
                tipoPronostico: currentAnalysisData.tipoPronostico,
                timestamp: new Date().toLocaleString('it-IT'),
                analysisData: currentAnalysisData
            };
            
            // Aggiunge il pronostico all'array
            savedForecasts.push(forecast);
            
            // Salva nel localStorage
            try {
                localStorage.setItem('savedForecasts', JSON.stringify(savedForecasts));
            } catch (error) {
                console.error('Errore nel salvataggio:', error);
                alert('Errore durante il salvataggio del pronostico');
                return;
            }
            
            // Aggiorna la visualizzazione
            aggiornaPronosticiSalvati();
            
            // Mostra conferma
            alert('‚úÖ Pronostico salvato con successo!');
        }

        function aggiornaPronosticiSalvati() {
            const container = document.getElementById('savedForecastsList');
            
            if (!Array.isArray(savedForecasts) || savedForecasts.length === 0) {
                container.innerHTML = `
                    <div class="no-saved">
                        <i class="bi bi-inbox fs-1"></i>
                        <p>Nessun pronostico salvato</p>
                        <small>I tuoi pronostici salvati appariranno qui</small>
                    </div>
                `;
                return;
            }
            
            // Ordina i pronostici per data (dal pi√π recente)
            savedForecasts.sort((a, b) => b.id - a.id);
            
            // Genera l'HTML per ogni pronostico salvato
            container.innerHTML = savedForecasts.map(forecast => `
                <div class="saved-item" onclick="mostraDettaglioPronostico(${forecast.id})">
                    <div class="saved-item-header">
                        <span class="saved-item-sport">${forecast.sport === 'basket' ? 'üèÄ Basket' : '‚öΩ Calcio'}</span>
                        <span class="saved-item-date">${forecast.timestamp}</span>
                    </div>
                    <div class="saved-item-match">${forecast.squadra1} vs ${forecast.squadra2}</div>
                    <div class="saved-item-forecast">${forecast.pronostico}</div>
                    <div class="saved-item-stats">
                        <div class="saved-item-stat">
                            <div class="saved-item-stat-value">${forecast.probabilita}</div>
                            <div class="saved-item-stat-label">Probabilit√†</div>
                        </div>
                        <div class="saved-item-stat">
                            <div class="saved-item-stat-value">${forecast.quotaTeorica}</div>
                            <div class="saved-item-stat-label">Quota Teorica</div>
                        </div>
                        <div class="saved-item-stat">
                            <div class="saved-item-stat-value ${forecast.valueMargin.includes('+') ? 'value-positive' : 'value-negative'}">${forecast.valueMargin}</div>
                            <div class="saved-item-stat-label">Value</div>
                        </div>
                    </div>
                    <div class="saved-item-actions">
                        <button class="delete-saved" onclick="event.stopPropagation(); eliminaPronostico(${forecast.id})">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function eliminaPronostico(id) {
            if (!confirm('Sei sicuro di voler eliminare questo pronostico?')) {
                return;
            }
            
            savedForecasts = savedForecasts.filter(forecast => forecast.id !== id);
            
            try {
                localStorage.setItem('savedForecasts', JSON.stringify(savedForecasts));
                aggiornaPronosticiSalvati();
            } catch (error) {
                console.error('Errore nel salvataggio:', error);
                alert('Errore durante l\'eliminazione del pronostico');
            }
        }
    </script>
</body>
</html>


