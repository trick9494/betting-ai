<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Betting AI ‚Äì MultiSport Pro</title>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        body.dark-mode {
            background-color: #121212;
            color: #f0f0f0;
        }
        .dark-mode input, .dark-mode select, .dark-mode textarea {
            background-color: #1e1e1e;
            color: #ffffff;
            border: 1px solid #444;
        }
        .dark-mode button {
            background-color: #333;
            color: #fff;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
        }
        .dark-mode button:hover {
            background-color: #555;
        }
        .header {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-radius: 0 0 10px 10px;
        }
        .metric-card {
            background-color: #f0f2f6;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #1f77b4;
            transition: background-color 0.3s;
        }
        .dark-mode .metric-card {
            background-color: #2a2a2a;
        }
        .success-card {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
        }
        .dark-mode .success-card {
            background-color: #1e4620;
        }
        .warning-card {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        .dark-mode .warning-card {
            background-color: #42350e;
        }
        .danger-card {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        .dark-mode .danger-card {
            background-color: #4a1c24;
        }
        .sport-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .sport-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .active-sport {
            border: 3px solid #0d6efd;
            background-color: #e8f4ff;
        }
        .dark-mode .active-sport {
            background-color: #1e3a5f;
        }
        .hidden {
            display: none;
        }
        .consiglio-box {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .value-positive {
            color: #28a745;
            font-weight: bold;
        }
        .value-negative {
            color: #dc3545;
            font-weight: bold;
        }
        .saved-forecast {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: white;
            transition: background-color 0.3s;
        }
        .dark-mode .saved-forecast {
            background-color: #2a2a2a;
            border-color: #444;
        }
        .saved-forecast-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .dark-mode .saved-forecast-header {
            border-bottom-color: #444;
        }
        .toggle-dark-mode {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        .form-text {
            font-size: 0.875em;
            color: #6c757d;
        }
        .dark-mode .form-text {
            color: #adb5bd;
        }
        .error-message {
            color: #dc3545;
            font-size: 0.875em;
            margin-top: 5px;
        }
        .chart-container {
            margin-bottom: 20px;
        }
        .ai-analysis-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .reason-item {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 10px 15px;
            margin: 8px 0;
            border-left: 4px solid #4CAF50;
        }
        .warning-reason {
            border-left-color: #FFC107;
        }
        .danger-reason {
            border-left-color: #F44336;
        }
        .market-badge {
            background: #6f42c1;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            margin-left: 8px;
        }
        .tipo-pronostico {
            background: #17a2b8;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75em;
        }
        .pronostico-option {
            padding: 8px 12px;
            margin: 2px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .pronostico-option:hover {
            background-color: #e9ecef;
        }
        .dark-mode .pronostico-option:hover {
            background-color: #2a2a2a;
        }
        .dropdown-menu-pronostico {
            max-height: 300px;
            overflow-y: auto;
        }
        .dropdown-toggle-pronostico {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .dropdown-toggle-pronostico::after {
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="header text-center">
        <h1><i class="bi bi-bullseye"></i> Betting AI ‚Äì MultiSport Pro</h1>
        <p class="lead">Analisi intelligente per TUTTI i mercati dei bookmaker</p>
    </div>

    <div class="container">
        <div class="row mb-4">
            <div class="col-12">
                <h3 class="mb-3">üèÜ Scegli lo sport</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card sport-card text-center active-sport" id="basket-card" onclick="showSport('basket')">
                            <div class="card-body">
                                <i class="bi bi-basketball fs-1"></i>
                                <h5 class="card-title">Basket</h5>
                                <small class="text-muted">NBA, Euroleague, etc.</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card sport-card text-center" id="calcio-card" onclick="showSport('calcio')">
                            <div class="card-body">
                                <i class="bi bi-file-earmark-text fs-1"></i>
                                <h5 class="card-title">Calcio</h5>
                                <small class="text-muted">Serie A, Champions, etc.</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <hr>

        <!-- BASKET SECTION -->
        <div id="basket-section">
            <h3 class="mb-4"><i class="bi bi-basketball"></i> Basket ‚Äì Analisi Multi-Mercato</h3>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üèÄ Squadra 1</label>
                        <input type="text" class="form-control" id="basket-squadra1" placeholder="es. Los Angeles Lakers" required>
                        <div class="error-message" id="basket-squadra1-error"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üèÄ Squadra 2</label>
                        <input type="text" class="form-control" id="basket-squadra2" placeholder="es. Golden State Warriors" required>
                        <div class="error-message" id="basket-squadra2-error"></div>
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label class="form-label">üéØ Tipo Pronostico Basket</label>
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-pronostico w-100" type="button" id="dropdownBasket" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="selected-basket-option">üèÄ Punti Giocatore</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-pronostico w-100" aria-labelledby="dropdownBasket">
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('punti-over-under', 'üèÄ Punti Giocatore')">üèÄ Punti Giocatore<br><small>Over/Under punti giocatore</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('rimbalzi-over-under', 'üìà Rimbalzi Giocatore')">üìà Rimbalzi Giocatore<br><small>Over/Under rimbalzi</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('assist-over-under', 'üéØ Assist Giocatore')">üéØ Assist Giocatore<br><small>Over/Under assist</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('performance-multipla', '‚≠ê Performance Multiple')">‚≠ê Performance Multiple<br><small>Punti+Rimbalzi+Assist</small></a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('vincitore', 'üèÜ Vincitore Partita')">üèÜ Vincitore Partita<br><small>1, X, 2</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('handicap', '‚öñÔ∏è Handicap')">‚öñÔ∏è Handicap<br><small>Handicap punti</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('punti-totali', 'üî¢ Punti Totali Partita')">üî¢ Punti Totali Partita<br><small>Over/Under punti totali</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoBasket('custom', '‚úèÔ∏è Personalizzato')">‚úèÔ∏è Personalizzato<br><small>Altri mercati</small></a></li>
                    </ul>
                </div>
                <input type="hidden" id="basket-tipo-pronostico" value="punti-over-under">
            </div>
            
            <div class="mb-3">
                <label class="form-label">üìä Pronostico Specifico</label>
                <input type="text" class="form-control" id="basket-pronostico" placeholder="es. LeBron James Over 27.5 punti" required>
                <div class="error-message" id="basket-pronostico-error"></div>
                <div class="form-text" id="basket-esempi-pronostico">
                    Esempi: "LeBron James Over 27.5 punti", "Jokic Under 9.5 rimbalzi", "Lakers vincenti"
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üìà Valore statistico rilevante</label>
                        <input type="number" step="0.1" class="form-control" id="basket-totale" value="0" min="0">
                        <div class="form-text">Media punti/rimbalzi/assist del giocatore o squadra</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üî¢ Numero eventi analizzati</label>
                        <input type="number" step="1" class="form-control" id="basket-eventi" value="0" min="0">
                        <div class="form-text">Partite/eventi considerati per la statistica</div>
                    </div>
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üéØ Soglia pronostico</label>
                        <input type="number" step="0.1" class="form-control" id="basket-soglia" value="0" min="0">
                        <div class="form-text">Soglia del bookmaker (es. 27.5 per Over 27.5 punti)</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üí∞ Quota bookmaker</label>
                        <input type="number" step="0.01" class="form-control" id="basket-quota" value="1.80" min="1.01">
                    </div>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="form-label">üìä Successi storici</label>
                <input type="text" class="form-control" id="basket-successi" placeholder="es. 6 su 10, 70%">
                <div class="form-text">Quante volte √® successo storicamente? (es. "6/10" o "70%")</div>
            </div>
            
            <div class="d-grid gap-2">
                <button class="btn btn-primary btn-lg" onclick="analizzaBasket()"><i class="bi bi-cpu"></i> Analisi AI Avanzata</button>
            </div>
            
            <div id="basket-results" class="mt-4 hidden">
                <h3 class="mb-4">üìä Risultati Analisi Multi-Mercato</h3>
                
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Probabilit√†</h6>
                            <h3 id="basket-probabilita">0%</h3>
                            <span id="basket-prob-diff">+0.0%</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Quota Teorica</h6>
                            <h3 id="basket-quota-teorica">0.00</h3>
                            <span id="basket-quota-diff">+0.00</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Value Margin</h6>
                            <h3 id="basket-value-margin">+0.0%</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Mercato</h6>
                            <h3 id="basket-mercato">-</h3>
                            <span id="basket-tipo">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div id="basket-grafico-prob"></div>
                    <div id="basket-grafico-quote"></div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">Dettagli Analisi</h5>
                        <p><strong>üèÄ Match:</strong> <span id="basket-match"></span></p>
                        <p><strong>üìä Pronostico:</strong> <span id="basket-pronostico-result"></span> <span class="tipo-pronostico" id="basket-tipo-badge"></span></p>
                        <p><strong>üìà Media Statistica:</strong> <span id="basket-media"></span></p>
                        <p><strong>üéØ Soglia Bookmaker:</strong> <span id="basket-soglia-result"></span></p>
                        <p><strong>üîç Metodo Analisi:</strong> <span id="basket-metodo"></span></p>
                        <p><strong>üìä Successi Storici:</strong> <span id="basket-successi-result"></span></p>
                    </div>
                </div>
                
                <!-- ANALISI DETTAGLIATA AI -->
                <div id="basket-analisi-ai" class="ai-analysis-card">
                    <h4 class="text-center mb-4">üß† Analisi Dettagliata AI</h4>
                    <div id="basket-ragionamento-ai"></div>
                </div>
                
                <div id="basket-consiglio" class="consiglio-box"></div>
                
                <div class="d-grid gap-2 mt-3">
                    <button class="btn btn-success" onclick="salvaPronostico('basket')"><i class="bi bi-save"></i> Salva Pronostico</button>
                </div>
            </div>
        </div>

        <!-- CALCIO SECTION -->
        <div id="calcio-section" class="hidden">
            <h3 class="mb-4"><i class="bi bi-file-earmark-text"></i> Calcio ‚Äì Analisi Multi-Mercato</h3>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">‚öΩ Squadra 1</label>
                        <input type="text" class="form-control" id="calcio-squadra1" placeholder="es. Juventus" required>
                        <div class="error-message" id="calcio-squadra1-error"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">‚öΩ Squadra 2</label>
                        <input type="text" class="form-control" id="calcio-squadra2" placeholder="es. Inter" required>
                        <div class="error-message" id="calcio-squadra2-error"></div>
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label class="form-label">üéØ Tipo Pronostico Calcio</label>
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-pronostico w-100" type="button" id="dropdownCalcio" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="selected-calcio-option">ü•Ö Over/Under Gol</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-pronostico w-100" aria-labelledby="dropdownCalcio">
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('over-under-gol', 'ü•Ö Over/Under Gol')">ü•Ö Over/Under Gol<br><small>0.5, 1.5, 2.5, 3.5 gol</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('doppia-chance', 'üîÑ Doppia Chance')">üîÑ Doppia Chance<br><small>1X, X2, 12</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('risultato-esatto', 'üéØ Risultato Esatto')">üéØ Risultato Esatto<br><small>1-0, 2-1, 3-2, etc.</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('gol-nogol', '‚ùå Gol/No Gol')">‚ùå Gol/No Gol<br><small>Gol, No Gol</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('both-teams', '‚öΩ Both Teams to Score')">‚öΩ Both Teams to Score<br><small>Si, No</small></a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('pari-dispari', 'üî¢ Pari/Dispari')">üî¢ Pari/Dispari<br><small>Pari, Dispari</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('corner', 'üìê Corner')">üìê Corner<br><small>Over/Under corner</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('cartellini', 'üü® Cartellini')">üü® Cartellini<br><small>Over/Under cartellini</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('primo-tempo', '‚è±Ô∏è Primo Tempo')">‚è±Ô∏è Primo Tempo<br><small>Risultati 1¬∞ tempo</small></a></li>
                        <li><a class="dropdown-item" href="#" onclick="selezionaPronosticoCalcio('vincitore', 'üèÜ Vincitore')">üèÜ Vincitore<br><small>1, X, 2</small></a></li>
                    </ul>
                </div>
                <input type="hidden" id="calcio-tipo-pronostico" value="over-under-gol">
            </div>
            
            <div class="mb-3">
                <label class="form-label">üìä Pronostico Specifico</label>
                <input type="text" class="form-control" id="calcio-pronostico" placeholder="es. Over 2.5 gol" required>
                <div class="error-message" id="calcio-pronostico-error"></div>
                <div class="form-text" id="calcio-esempi-pronostico">
                    Esempi: "Over 2.5 gol", "1X", "2-1", "Gol", "Si - Both teams to score"
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üìà Media Gol/Eventi Squadra 1</label>
                        <input type="number" step="0.1" class="form-control" id="calcio-media1" value="0" min="0">
                        <div class="form-text">Media gol fatti/subiti per la squadra 1</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üìà Media Gol/Eventi Squadra 2</label>
                        <input type="number" step="0.1" class="form-control" id="calcio-media2" value="0" min="0">
                        <div class="form-text">Media gol fatti/subiti per la squadra 2</div>
                    </div>
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üéØ Soglia pronostico</label>
                        <input type="number" step="0.1" class="form-control" id="calcio-soglia" value="0" min="0">
                        <div class="form-text">Soglia del bookmaker (es. 2.5 per Over 2.5 gol)</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">üí∞ Quota bookmaker</label>
                        <input type="number" step="0.01" class="form-control" id="calcio-quota" value="1.80" min="1.01">
                    </div>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="form-label">üìä Successi storici</label>
                <input type="text" class="form-control" id="calcio-successi" placeholder="es. 7 su 10, 65%">
                <div class="form-text">Quante volte √® successo storicamente? (es. "7/10" o "65%")</div>
            </div>
            
            <div class="d-grid gap-2">
                <button class="btn btn-primary btn-lg" onclick="analizzaCalcio()"><i class="bi bi-cpu"></i> Analisi AI Avanzata</button>
            </div>
            
            <div id="calcio-results" class="mt-4 hidden">
                <h3 class="mb-4">üìä Risultati Analisi Multi-Mercato</h3>
                
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Probabilit√†</h6>
                            <h3 id="calcio-probabilita">0%</h3>
                            <span id="calcio-prob-diff">+0.0%</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Quota Teorica</h6>
                            <h3 id="calcio-quota-teorica">0.00</h3>
                            <span id="calcio-quota-diff">+0.00</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Value Margin</h6>
                            <h3 id="calcio-value-margin">+0.0%</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <h6>Mercato</h6>
                            <h3 id="calcio-mercato">-</h3>
                            <span id="calcio-tipo">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div id="calcio-grafico-prob"></div>
                    <div id="calcio-grafico-quote"></div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">Dettagli Analisi</h5>
                        <p><strong>‚öΩ Match:</strong> <span id="calcio-match"></span></p>
                        <p><strong>üìä Pronostico:</strong> <span id="calcio-pronostico-result"></span> <span class="tipo-pronostico" id="calcio-tipo-badge"></span></p>
                        <p><strong>üìà Media Squadra 1:</strong> <span id="calcio-media1-result"></span> | <strong>Media Squadra 2:</strong> <span id="calcio-media2-result"></span></p>
                        <p><strong>üî¢ Media Combinata:</strong> <span id="calcio-media-combinata"></span></p>
                        <p><strong>üéØ Soglia Bookmaker:</strong> <span id="calcio-soglia-result"></span></p>
                        <p><strong>üîç Metodo Analisi:</strong> <span id="calcio-metodo"></span></p>
                        <p><strong>üìä Successi Storici:</strong> <span id="calcio-successi-result"></span></p>
                    </div>
                </div>
                
                <!-- ANALISI DETTAGLIATA AI -->
                <div id="calcio-analisi-ai" class="ai-analysis-card">
                    <h4 class="text-center mb-4">üß† Analisi Dettagliata AI</h4>
                    <div id="calcio-ragionamento-ai"></div>
                </div>
                
                <div id="calcio-consiglio" class="consiglio-box"></div>
                
                <div class="d-grid gap-2 mt-3">
                    <button class="btn btn-success" onclick="salvaPronostico('calcio')"><i class="bi bi-save"></i> Salva Pronostico</button>
                </div>
            </div>
        </div>

        <!-- SEZIONE PRONOSTICI SALVATI -->
        <div id="saved-section" class="mt-5">
            <h3 class="mb-4"><i class="bi bi-bookmark"></i> Pronostici Salvati</h3>
            <div id="saved-forecasts" class="row">
                <!-- I pronostici salvati verranno inseriti qui -->
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-4 mt-5">
        <p class="mb-0">Betting AI ‚Äì MultiSport Pro &copy; 2023. Supporta tutti i mercati dei bookmaker.</p>
    </footer>

    <button class="toggle-dark-mode" onclick="toggleDarkMode()">üåì</button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // FUNZIONI BASE
        function calcolaProbabilita(num, den) {
            return den > 0 ? Math.round((num / den) * 100 * 10) / 10 : 0.0;
        }

        function calcolaQuotaTeorica(prob) {
            return prob > 0 ? Math.round(100 / prob * 100) / 100 : 100.0;
        }

        function mostraSezione(sport) {
            document.getElementById('basket-section').classList.add('hidden');
            document.getElementById('calcio-section').classList.add('hidden');
            document.getElementById('basket-card').classList.remove('active-sport');
            document.getElementById('calcio-card').classList.remove('active-sport');
            document.getElementById(sport + '-section').classList.remove('hidden');
            document.getElementById(sport + '-card').classList.add('active-sport');
        }

        function showSport(sport) {
            mostraSezione(sport);
        }

        // SELEZIONE PRONOSTICI BASKET
        function selezionaPronosticoBasket(tipo, testo) {
            document.getElementById('basket-tipo-pronostico').value = tipo;
            document.getElementById('selected-basket-option').textContent = testo;
            aggiornaEsempiBasket();
        }

        // SELEZIONE PRONOSTICI CALCIO
        function selezionaPronosticoCalcio(tipo, testo) {
            document.getElementById('calcio-tipo-pronostico').value = tipo;
            document.getElementById('selected-calcio-option').textContent = testo;
            aggiornaEsempiCalcio();
        }

        // AGGIORNA ESEMPI
        function aggiornaEsempiBasket() {
            var tipo = document.getElementById('basket-tipo-pronostico').value;
            var esempiElement = document.getElementById('basket-esempi-pronostico');
            
            switch(tipo) {
                case 'punti-over-under':
                    esempiElement.textContent = 'Esempi: "LeBron James Over 27.5 punti", "Curry Under 25.5 punti", "Doncic Over 30.5 punti"';
                    break;
                case 'rimbalzi-over-under':
                    esempiElement.textContent = 'Esempi: "Jokic Over 9.5 rimbalzi", "Gobert Under 11.5 rimbalzi", "Davis Over 10.5 rimbalzi"';
                    break;
                case 'assist-over-under':
                    esempiElement.textContent = 'Esempi: "Trae Young Over 9.5 assist", "Chris Paul Under 8.5 assist", "Haliburton Over 10.5 assist"';
                    break;
                case 'performance-multipla':
                    esempiElement.textContent = 'Esempi: "Jokic Over 40.5 P+R+A", "Giannis Under 45.5 P+R+A", "Doncic Over 50.5 P+R+A"';
                    break;
                case 'vincitore':
                    esempiElement.textContent = 'Esempi: "Lakers vincenti", "Warriors vincenti", "Celtics vincenti"';
                    break;
                case 'handicap':
                    esempiElement.textContent = 'Esempi: "Lakers -5.5", "Warriors +3.5", "Celtics -2.5"';
                    break;
                case 'punti-totali':
                    esempiElement.textContent = 'Esempi: "Over 220.5 punti totali", "Under 215.5 punti totali", "Over 230.5 punti totali"';
                    break;
                case 'custom':
                    esempiElement.textContent = 'Inserisci qualsiasi pronostico personalizzato per il basket';
                    break;
            }
        }

        function aggiornaEsempiCalcio() {
            var tipo = document.getElementById('calcio-tipo-pronostico').value;
            var esempiElement = document.getElementById('calcio-esempi-pronostico');
            
            switch(tipo) {
                case 'over-under-gol':
                    esempiElement.textContent = 'Esempi: "Over 2.5 gol", "Under 3.5 gol", "Over 1.5 gol"';
                    break;
                case 'doppia-chance':
                    esempiElement.textContent = 'Esempi: "1X", "X2", "12"';
                    break;
                case 'risultato-esatto':
                    esempiElement.textContent = 'Esempi: "2-1", "1-1", "3-0", "0-2"';
                    break;
                case 'gol-nogol':
                    esempiElement.textContent = 'Esempi: "Gol", "No Gol"';
                    break;
                case 'both-teams':
                    esempiElement.textContent = 'Esempi: "Si - Both teams to score", "No - Both teams to score"';
                    break;
                case 'pari-dispari':
                    esempiElement.textContent = 'Esempi: "Pari", "Dispari"';
                    break;
                case 'corner':
                    esempiElement.textContent = 'Esempi: "Over 9.5 corner", "Under 8.5 corner", "Over 10.5 corner"';
                    break;
                case 'cartellini':
                    esempiElement.textContent = 'Esempi: "Over 4.5 cartellini", "Under 3.5 cartellini", "Over 5.5 cartellini"';
                    break;
                case 'primo-tempo':
                    esempiElement.textContent = 'Esempi: "1 primo tempo", "X primo tempo", "Over 1.5 gol primo tempo"';
                    break;
                case 'vincitore':
                    esempiElement.textContent = 'Esempi: "1", "X", "2"';
                    break;
            }
        }

        // VALIDAZIONE
        function validaCampi(sport) {
            var valid = true;
            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            
            var squadra1 = document.getElementById(sport + '-squadra1').value;
            var squadra2 = document.getElementById(sport + '-squadra2').value;
            var pronostico = document.getElementById(sport + '-pronostico').value;
            
            if (!squadra1) {
                document.getElementById(sport + '-squadra1-error').textContent = 'Campo obbligatorio';
                valid = false;
            }
            if (!squadra2) {
                document.getElementById(sport + '-squadra2-error').textContent = 'Campo obbligatorio';
                valid = false;
            }
            if (!pronostico) {
                document.getElementById(sport + '-pronostico-error').textContent = 'Campo obbligatorio';
                valid = false;
            }
            
            return valid;
        }

        // ANALISI BASKET
        function analizzaBasket() {
            if (!validaCampi('basket')) {
                alert('‚ùå Compila tutti i campi obbligatori!');
                return;
            }
            
            var squadra1 = document.getElementById('basket-squadra1').value;
            var squadra2 = document.getElementById('basket-squadra2').value;
            var pronostico = document.getElementById('basket-pronostico').value;
            var totale = parseFloat(document.getElementById('basket-totale').value) || 0;
            var eventi = parseInt(document.getElementById('basket-eventi').value) || 0;
            var soglia = parseFloat(document.getElementById('basket-soglia').value) || 0;
            var quota = parseFloat(document.getElementById('basket-quota').value) || 1.80;
            var successi = document.getElementById('basket-successi').value;
            var tipoPronostico = document.getElementById('basket-tipo-pronostico').value;
            
            try {
                var media = eventi > 0 ? Math.round((totale / eventi) * 100) / 100 : 0.0;
                var prob, successiTxt, metodo;
                
                if (successi.includes("su") && successi.trim()) {
                    var parts = successi.split("su");
                    var n = parseInt(parts[0]);
                    var d = parseInt(parts[1]);
                    prob = calcolaProbabilita(n, d);
                    successiTxt = n + " su " + d;
                    metodo = "üìä DATI STORICI";
                } else if (successi.includes("%")) {
                    prob = parseFloat(successi.replace('%', ''));
                    successiTxt = successi;
                    metodo = "üìä DATI STORICI";
                } else {
                    if (media > 0 && soglia > 0) {
                        if (pronostico.toLowerCase().includes("over")) {
                            prob = Math.min(80, 50 + (media - soglia) * 8);
                        } else if (pronostico.toLowerCase().includes("under")) {
                            prob = Math.max(20, 50 - (soglia - media) * 8);
                        } else {
                            prob = 50.0;
                        }
                    } else {
                        prob = 50.0;
                    }
                    successiTxt = "Stimato da media statistica";
                    metodo = "ü§ñ STIMA AI";
                }
                
                var quotaTeo = calcolaQuotaTeorica(prob);
                var valueMargin = quotaTeo > 0 ? ((quota / quotaTeo) - 1) * 100 : 0;
                
                // AGGIORNA RISULTATI
                document.getElementById('basket-probabilita').textContent = prob + '%';
                document.getElementById('basket-prob-diff').textContent = (prob - 50 >= 0 ? '+' : '') + (prob - 50).toFixed(1) + '%';
                document.getElementById('basket-prob-diff').className = (prob - 50 >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('basket-quota-teorica').textContent = quotaTeo.toFixed(2);
                document.getElementById('basket-quota-diff').textContent = (quotaTeo - quota >= 0 ? '+' : '') + (quotaTeo - quota).toFixed(2);
                document.getElementById('basket-quota-diff').className = (quotaTeo - quota >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('basket-value-margin').textContent = (valueMargin >= 0 ? '+' : '') + valueMargin.toFixed(1) + '%';
                document.getElementById('basket-value-margin').className = (valueMargin >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('basket-match').textContent = squadra1 + ' vs ' + squadra2;
                document.getElementById('basket-pronostico-result').textContent = pronostico;
                document.getElementById('basket-media').textContent = media;
                document.getElementById('basket-soglia-result').textContent = soglia;
                document.getElementById('basket-metodo').textContent = metodo;
                document.getElementById('basket-successi-result').textContent = successiTxt;
                
                // Aggiorna tipo mercato
                var tipoTesto = getTipoPronosticoTesto(tipoPronostico);
                document.getElementById('basket-mercato').textContent = tipoTesto.mercato;
                document.getElementById('basket-tipo').textContent = tipoTesto.tipo;
                document.getElementById('basket-tipo-badge').textContent = tipoTesto.badge;
                
                // CREA GRAFICI
                creaGraficoAnalisi(prob, quota, quotaTeo, "Basket", "basket-grafico");
                
                // GENERA ANALISI AI
                var analisiDettagliata = generaAnalisiDettagliataAI('basket', pronostico, media, soglia, prob, quota, quotaTeo, valueMargin, successiTxt, metodo);
                document.getElementById('basket-ragionamento-ai').innerHTML = analisiDettagliata;
                
                // GENERA CONSIGLIO
                var consiglio = analisiAvanzataAI(pronostico, media, soglia, prob, quota, quotaTeo);
                document.getElementById('basket-consiglio').innerHTML = consiglio;
                
                // MOSTRA RISULTATI
                document.getElementById('basket-results').classList.remove('hidden');
                
            } catch (e) {
                alert("‚ùå Errore nel calcolo: " + e.message);
            }
        }

        // ANALISI CALCIO
        function analizzaCalcio() {
            if (!validaCampi('calcio')) {
                alert('‚ùå Compila tutti i campi obbligatori!');
                return;
            }
            
            var squadra1 = document.getElementById('calcio-squadra1').value;
            var squadra2 = document.getElementById('calcio-squadra2').value;
            var pronostico = document.getElementById('calcio-pronostico').value;
            var media1 = parseFloat(document.getElementById('calcio-media1').value) || 0;
            var media2 = parseFloat(document.getElementById('calcio-media2').value) || 0;
            var soglia = parseFloat(document.getElementById('calcio-soglia').value) || 0;
            var quota = parseFloat(document.getElementById('calcio-quota').value) || 1.80;
            var successi = document.getElementById('calcio-successi').value;
            var tipoPronostico = document.getElementById('calcio-tipo-pronostico').value;
            
            try {
                var media = Math.round((media1 + media2) * 100) / 100;
                var prob, successiTxt, metodo;
                
                if (successi.includes("su") && successi.trim()) {
                    var parts = successi.split("su");
                    var n = parseInt(parts[0]);
                    var d = parseInt(parts[1]);
                    prob = calcolaProbabilita(n, d);
                    successiTxt = n + " su " + d;
                    metodo = "üìä DATI STORICI";
                } else if (successi.includes("%")) {
                    prob = parseFloat(successi.replace('%', ''));
                    successiTxt = successi;
                    metodo = "üìä DATI STORICI";
                } else {
                    if (media > 0 && soglia > 0) {
                        if (pronostico.toLowerCase().includes("over")) {
                            prob = Math.min(75, 50 + (media - soglia) * 10);
                        } else if (pronostico.toLowerCase().includes("under")) {
                            prob = Math.max(25, 50 - (soglia - media) * 10);
                        } else {
                            prob = 50.0;
                        }
                    } else {
                        prob = 50.0;
                    }
                    successiTxt = "Stimato da medie squadre";
                    metodo = "ü§ñ STIMA AI";
                }
                
                var quotaTeo = calcolaQuotaTeorica(prob);
                var valueMargin = quotaTeo > 0 ? ((quota / quotaTeo) - 1) * 100 : 0;
                
                // AGGIORNA RISULTATI
                document.getElementById('calcio-probabilita').textContent = prob + '%';
                document.getElementById('calcio-prob-diff').textContent = (prob - 50 >= 0 ? '+' : '') + (prob - 50).toFixed(1) + '%';
                document.getElementById('calcio-prob-diff').className = (prob - 50 >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('calcio-quota-teorica').textContent = quotaTeo.toFixed(2);
                document.getElementById('calcio-quota-diff').textContent = (quotaTeo - quota >= 0 ? '+' : '') + (quotaTeo - quota).toFixed(2);
                document.getElementById('calcio-quota-diff').className = (quotaTeo - quota >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('calcio-value-margin').textContent = (valueMargin >= 0 ? '+' : '') + valueMargin.toFixed(1) + '%';
                document.getElementById('calcio-value-margin').className = (valueMargin >= 0 ? 'value-positive' : 'value-negative');
                
                document.getElementById('calcio-match').textContent = squadra1 + ' vs ' + squadra2;
                document.getElementById('calcio-pronostico-result').textContent = pronostico;
                document.getElementById('calcio-media1-result').textContent = media1;
                document.getElementById('calcio-media2-result').textContent = media2;
                document.getElementById('calcio-media-combinata').textContent = media;
                document.getElementById('calcio-soglia-result').textContent = soglia;
                document.getElementById('calcio-metodo').textContent = metodo;
                document.getElementById('calcio-successi-result').textContent = successiTxt;
                
                // Aggiorna tipo mercato
                var tipoTesto = getTipoPronosticoTesto(tipoPronostico);
                document.getElementById('calcio-mercato').textContent = tipoTesto.mercato;
                document.getElementById('calcio-tipo').textContent = tipoTesto.tipo;
                document.getElementById('calcio-tipo-badge').textContent = tipoTesto.badge;
                
                // CREA GRAFICI
                creaGraficoAnalisi(prob, quota, quotaTeo, "Calcio", "calcio-grafico");
                
                // GENERA ANALISI AI
                var analisiDettagliata = generaAnalisiDettagliataAI('calcio', pronostico, media, soglia, prob, quota, quotaTeo, valueMargin, successiTxt, metodo);
                document.getElementById('calcio-ragionamento-ai').innerHTML = analisiDettagliata;
                
                // GENERA CONSIGLIO
                var consiglio = analisiAvanzataAI(pronostico, media, soglia, prob, quota, quotaTeo);
                document.getElementById('calcio-consiglio').innerHTML = consiglio;
                
                // MOSTRA RISULTATI
                document.getElementById('calcio-results').classList.remove('hidden');
                
            } catch (e) {
                alert("‚ùå Errore nel calcolo: " + e.message);
            }
        }

        // Funzione per creare il grafico di analisi
        function creaGraficoAnalisi(prob, quota, quotaTeo, sport, containerId) {
            var indicatorData = {
                type: "indicator",
                mode: "gauge+number+delta",
                value: prob,
                domain: { x: [0, 1], y: [0, 1] },
                title: { text: "Probabilit√† %" },
                delta: { reference: 50 },
                gauge: {
                    axis: { range: [null, 100] },
                    bar: { color: "darkblue" },
                    steps: [
                        { range: [0, 40], color: "lightgray" },
                        { range: [40, 60], color: "yellow" },
                        { range: [60, 100], color: "green" }
                    ],
                    threshold: {
                        line: { color: "red", width: 4 },
                        thickness: 0.75,
                        value: 60
                    }
                }
            };

            var barData = {
                type: "bar",
                x: ['Quota Teorica', 'Quota Bookmaker'],
                y: [quotaTeo, quota],
                marker: {
                    color: ['lightblue', 'darkblue']
                },
                text: [quotaTeo.toFixed(2), quota.toFixed(2)],
                textposition: 'auto'
            };

            var indicatorLayout = {
                title: `Probabilit√† ${sport}`,
                height: 400
            };

            var barLayout = {
                title: `Confronto Quote ${sport}`,
                height: 400
            };

            Plotly.newPlot(containerId + '-prob', [indicatorData], indicatorLayout);
            Plotly.newPlot(containerId + '-quote', [barData], barLayout);
        }

        // Funzione per l'analisi avanzata AI
        function analisiAvanzataAI(esito, media, soglia, prob, quota, quotaTeo) {
            var valueMargin = quotaTeo > 0 ? ((quota / quotaTeo) - 1) * 100 : 0;
            
            if (esito.toLowerCase().includes("over")) {
                var confidenceScore = 0;
                
                if (media > soglia * 1.2) {
                    confidenceScore += 40;
                } else if (media > soglia) {
                    confidenceScore += 20;
                } else if (media > soglia * 0.9) {
                    confidenceScore += 10;
                }
                
                if (prob > 70) {
                    confidenceScore += 30;
                } else if (prob > 60) {
                    confidenceScore += 20;
                } else if (prob > 50) {
                    confidenceScore += 10;
                }
                
                if (valueMargin > 20) {
                    confidenceScore += 20;
                } else if (valueMargin > 10) {
                    confidenceScore += 10;
                } else if (valueMargin > 0) {
                    confidenceScore += 5;
                }
                
                if (media > soglia && prob > 60) {
                    confidenceScore += 10;
                }
                
                return generaConsiglioFinale("OVER", confidenceScore, valueMargin, prob);
            } else if (esito.toLowerCase().includes("under")) {
                var confidenceScore = 0;
                
                if (media < soglia * 0.8) {
                    confidenceScore += 40;
                } else if (media < soglia) {
                    confidenceScore += 20;
                } else if (media < soglia * 1.1) {
                    confidenceScore += 10;
                }
                
                if (prob > 70) {
                    confidenceScore += 30;
                } else if (prob > 60) {
                    confidenceScore += 20;
                } else if (prob > 50) {
                    confidenceScore += 10;
                }
                
                if (valueMargin > 20) {
                    confidenceScore += 20;
                } else if (valueMargin > 10) {
                    confidenceScore += 10;
                } else if (valueMargin > 0) {
                    confidenceScore += 5;
                }
                
                if (media < soglia && prob > 60) {
                    confidenceScore += 10;
                }
                
                return generaConsiglioFinale("UNDER", confidenceScore, valueMargin, prob);
            } else {
                var confidenceScore = 0;
                
                if (prob > 70) {
                    confidenceScore += 50;
                } else if (prob > 60) {
                    confidenceScore += 35;
                } else if (prob > 55) {
                    confidenceScore += 20;
                } else if (prob > 50) {
                    confidenceScore += 10;
                }
                
                if (valueMargin > 15) {
                    confidenceScore += 25;
                } else if (valueMargin > 5) {
                    confidenceScore += 15;
                } else if (valueMargin > 0) {
                    confidenceScore += 5;
                }
                
                return generaConsiglioFinale(esito.toUpperCase(), confidenceScore, valueMargin, prob);
            }
        }

        function generaConsiglioFinale(tipoScommessa, confidenceScore, valueMargin, prob) {
            if (confidenceScore >= 80) {
                return `<div class="success-card">
                    <h5>üöÄ <strong>FORTE RACCOMANDAZIONE ${tipoScommessa}</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>üéØ L'AI √® molto fiduciosa in questa scommessa!</p>
                </div>`;
            } else if (confidenceScore >= 60) {
                return `<div class="warning-card">
                    <h5>‚úÖ <strong>CONSIGLIO ${tipoScommessa}</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>üëç Buona opportunit√† secondo l'analisi AI.</p>
                </div>`;
            } else if (confidenceScore >= 40) {
                return `<div class="warning-card">
                    <h5>‚ö†Ô∏è <strong>${tipoScommessa} CON PRUDENZA</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>ü§î Possibile ma rischiosa. Considera stake ridotto.</p>
                </div>`;
            } else {
                return `<div class="danger-card">
                    <h5>‚ùå <strong>SCONSIGLIO ${tipoScommessa}</strong></h5>
                    <p>Confidenza AI: ${confidenceScore}%</p>
                    <p>üí∞ Value: +${valueMargin.toFixed(1)}% | Probabilit√†: ${prob}%</p>
                    <p>üö´ I dati non supportano questa scommessa.</p>
                </div>`;
            }
        }

        // Funzione per generare analisi dettagliata AI
        function generaAnalisiDettagliataAI(sport, pronostico, media, soglia, prob, quota, quotaTeo, valueMargin, successi, metodo) {
            var analisiHTML = '';
            var ragionamenti = [];
            
            // Analisi basata sul tipo di pronostico
            if (pronostico.toLowerCase().includes("over")) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üìà <strong>Media vs Soglia:</strong> La media (${media}) √® ${media > soglia ? 'superiore' : 'inferiore'} alla soglia (${soglia}) - ${media > soglia ? 'favorevole per OVER' : 'sfavorevole per OVER'}`
                });
            } else if (pronostico.toLowerCase().includes("under")) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üìâ <strong>Media vs Soglia:</strong> La media (${media}) √® ${media < soglia ? 'inferiore' : 'superiore'} alla soglia (${soglia}) - ${media < soglia ? 'favorevole per UNDER' : 'sfavorevole per UNDER'}`
                });
            }

            // Analisi probabilit√†
            if (prob >= 70) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üé≤ <strong>Alta Probabilit√†:</strong> ${prob}% di successo - livello di confidenza molto alto`
                });
            } else if (prob >= 60) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `‚úÖ <strong>Buona Probabilit√†:</strong> ${prob}% di successo - livello di confidenza solido`
                });
            } else if (prob >= 50) {
                ragionamenti.push({
                    tipo: "warning",
                    testo: `‚öñÔ∏è <strong>Probabilit√† Equilibrata:</strong> ${prob}% di successo - situazione bilanciata`
                });
            } else {
                ragionamenti.push({
                    tipo: "negative",
                    testo: `üìä <strong>Probabilit√† Bassa:</strong> Solo ${prob}% di successo - rischio significativo`
                });
            }

            // Analisi value bet
            if (valueMargin > 15) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üí∞ <strong>Value Bet Eccellente:</strong> +${valueMargin.toFixed(1)}% di valore - opportunit√† rara`
                });
            } else if (valueMargin > 5) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üíµ <strong>Buon Value Bet:</strong> +${valueMargin.toFixed(1)}% di valore - situazione favorevole`
                });
            } else if (valueMargin > 0) {
                ragionamenti.push({
                    tipo: "warning",
                    testo: `üìä <strong>Value Bet Limitato:</strong> +${valueMargin.toFixed(1)}% di valore - margine ridotto`
                });
            } else {
                ragionamenti.push({
                    tipo: "negative",
                    testo: `‚ùå <strong>Nessun Value Bet:</strong> ${valueMargin.toFixed(1)}% di valore - quota bookmaker non conveniente`
                });
            }

            // Analisi dati storici
            if (metodo.includes("STORICI")) {
                ragionamenti.push({
                    tipo: "positive",
                    testo: `üìö <strong>Dati Storici Solidi:</strong> Analisi basata su ${successi} - fondamento statistico robusto`
                });
            } else {
                ragionamenti.push({
                    tipo: "warning",
                    testo: `ü§ñ <strong>Stima AI:</strong> Probabilit√† calcolata algoritmicamente - attendibilit√† variabile`
                });
            }

            // Costruisci HTML
            ragionamenti.forEach(rag => {
                var classe = rag.tipo === "positive" ? "reason-item" : 
                            rag.tipo === "warning" ? "reason-item warning-reason" : 
                            "reason-item danger-reason";
                analisiHTML += `<div class="${classe}">${rag.testo}</div>`;
            });

            // Conclusione
            var conclusione = '';
            if (prob >= 70 && valueMargin > 10) {
                conclusione = `üéØ <strong>CONCLUSIONE AI:</strong> Combinazione eccellente di alta probabilit√† (${prob}%) e forte value bet (+${valueMargin.toFixed(1)}%). L'AI raccomanda fortemente questa scommessa.`;
            } else if (prob >= 60 && valueMargin > 5) {
                conclusione = `‚úÖ <strong>CONCLUSIONE AI:</strong> Buon bilanciamento tra probabilit√† (${prob}%) e valore (+${valueMargin.toFixed(1)}%). Scommessa consigliata con moderazione.`;
            } else if (prob >= 50 && valueMargin > 0) {
                conclusione = `‚öñÔ∏è <strong>CONCLUSIONE AI:</strong> Situazione equilibrata. Probabilit√† (${prob}%) e valore (+${valueMargin.toFixed(1)}%) sufficienti per considerare la scommessa.`;
            } else {
                conclusione = `‚ö†Ô∏è <strong>CONCLUSIONE AI:</strong> Fattori di rischio elevati. Probabilit√† (${prob}%) e valore (+${valueMargin.toFixed(1)}%) insufficienti per una raccomandazione.`;
            }

            analisiHTML += `<div class="reason-item" style="background: rgba(255,255,255,0.2); border-left-color: #2196F3;">${conclusione}</div>`;

            return analisiHTML;
        }

        // Funzione per ottenere il testo del tipo di pronostico
        function getTipoPronosticoTesto(tipo) {
            const tipi = {
                // Basket
                'punti-over-under': { mercato: 'Punti', tipo: 'O/U Giocatore', badge: 'üèÄ Punti' },
                'rimbalzi-over-under': { mercato: 'Rimbalzi', tipo: 'O/U Giocatore', badge: 'üìà Rimbalzi' },
                'assist-over-under': { mercato: 'Assist', tipo: 'O/U Giocatore', badge: 'üéØ Assist' },
                'performance-multipla': { mercato: 'Performance', tipo: 'Multipla', badge: '‚≠ê Performance' },
                'vincitore': { mercato: 'Vincitore', tipo: '1/X/2', badge: 'üèÜ Vincitore' },
                'handicap': { mercato: 'Handicap', tipo: 'Punti', badge: '‚öñÔ∏è Handicap' },
                'punti-totali': { mercato: 'Punti Totali', tipo: 'O/U Partita', badge: 'üî¢ P.Totali' },
                'custom': { mercato: 'Personalizzato', tipo: 'Vari', badge: '‚úèÔ∏è Custom' },
                // Calcio
                'over-under-gol': { mercato: 'O/U Gol', tipo: 'Gol', badge: 'ü•Ö O/U Gol' },
                'doppia-chance': { mercato: 'Doppia Chance', tipo: '1X/X2/12', badge: 'üîÑ D.Chance' },
                'risultato-esatto': { mercato: 'Ris. Esatto', tipo: 'Score', badge: 'üéØ R.Esatto' },
                'gol-nogol': { mercato: 'Gol/No Gol', tipo: 'G/NG', badge: '‚ùå G/NG' },
                'both-teams': { mercato: 'BTTS', tipo: 'Si/No', badge: '‚öΩ BTTS' },
                'pari-dispari': { mercato: 'Pari/Dispari', tipo: 'P/D', badge: 'üî¢ P/D' },
                'corner': { mercato: 'Corner', tipo: 'O/U', badge: 'üìê Corner' },
                'cartellini': { mercato: 'Cartellini', tipo: 'O/U', badge: 'üü® Cartellini' },
                'primo-tempo': { mercato: '1¬∞ Tempo', tipo: 'Parziale', badge: '‚è±Ô∏è 1¬∞T' },
                'vincitore': { mercato: 'Vincitore', tipo: '1/X/2', badge: 'üèÜ Vincitore' }
            };
            return tipi[tipo] || { mercato: 'Mercato', tipo: 'Tipo', badge: 'üìä' };
        }

        // Funzioni per salvare i pronostici e dark mode
        function salvaPronostico(sport) {
            // Implementazione semplificata per salvare i pronostici
            alert(`Pronostico ${sport} salvato! (funzione di salvataggio da implementare)`);
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        function caricaPronosticiSalvati() {
            // Implementazione per caricare i pronostici salvati
        }

        // INIZIALIZZAZIONE
        document.addEventListener('DOMContentLoaded', function() {
            mostraSezione('basket');
            caricaPronosticiSalvati();
            aggiornaEsempiBasket();
            aggiornaEsempiCalcio();
        });
    </script>
</body>
</html>


